<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emorie D Beck">

<title>Data Visualization (WQ25) - Week 3: Proportions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Visualization (WQ25)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="./01-week1-workbook.html">
 <span class="dropdown-text">Week 1 (Workbook) - Getting Situated in R and tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./01-week1-slides.html">
 <span class="dropdown-text">Week 1 (Slides) - Getting Situated in R and tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02-week2-workbook.html">
 <span class="dropdown-text">Week 2 (Workbook) - Introduction to ggplot2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02-week2-slides.html">
 <span class="dropdown-text">Week 2 (Slides) - Cognitive Perspectives and Introduction to ggplot2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03-week3-slides.html">
 <span class="dropdown-text">Week 3 (Slides) - Visualizing Proportions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03-week3-workbook.html">
 <span class="dropdown-text">Week 3: Proportions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-problem-sets" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Problem Sets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-problem-sets">    
        <li>
    <a class="dropdown-item" href="./ps1.html">
 <span class="dropdown-text">Problem Set 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-final-project" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Final Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-final-project">    
        <li>
    <a class="dropdown-item" href="./final-project-proposal.html">
 <span class="dropdown-text">Final Project Proposal</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#quick-review" id="toc-quick-review" class="nav-link active" data-scroll-target="#quick-review">Quick Review</a>
  <ul class="collapse">
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review">Review</a>
  <ul class="collapse">
  <li><a href="#what-are-the-core-elements-of-ggplot2-grammar" id="toc-what-are-the-core-elements-of-ggplot2-grammar" class="nav-link" data-scroll-target="#what-are-the-core-elements-of-ggplot2-grammar">What are the core elements of ggplot2 grammar?</a></li>
  </ul></li>
  <li><a href="#quick-review-1" id="toc-quick-review-1" class="nav-link" data-scroll-target="#quick-review-1">Quick Review</a>
  <ul class="collapse">
  <li><a href="#colorblindness-and-accessible-plots" id="toc-colorblindness-and-accessible-plots" class="nav-link" data-scroll-target="#colorblindness-and-accessible-plots">Colorblindness and accessible plots</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#proportions" id="toc-proportions" class="nav-link" data-scroll-target="#proportions">Proportions</a>
  <ul class="collapse">
  <li><a href="#visualizating-proportions" id="toc-visualizating-proportions" class="nav-link" data-scroll-target="#visualizating-proportions">Visualizating Proportions</a></li>
  <li><a href="#agenda" id="toc-agenda" class="nav-link" data-scroll-target="#agenda">Agenda</a></li>
  <li><a href="#but-first-our-data" id="toc-but-first-our-data" class="nav-link" data-scroll-target="#but-first-our-data">But First, Our Data</a></li>
  <li><a href="#pie-charts" id="toc-pie-charts" class="nav-link" data-scroll-target="#pie-charts"><span style="color:white;">Pie Charts</span></a></li>
  <li><a href="#pie-charts-1" id="toc-pie-charts-1" class="nav-link" data-scroll-target="#pie-charts-1"><span style="color:white;">Pie Charts</span></a></li>
  <li><a href="#pie-charts-2" id="toc-pie-charts-2" class="nav-link" data-scroll-target="#pie-charts-2"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#basic-syntax" id="toc-basic-syntax" class="nav-link" data-scroll-target="#basic-syntax">Basic Syntax</a></li>
  </ul></li>
  <li><a href="#pie-charts-3" id="toc-pie-charts-3" class="nav-link" data-scroll-target="#pie-charts-3"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-directly-label" id="toc-improvements-directly-label" class="nav-link" data-scroll-target="#improvements-directly-label">Improvements: Directly label</a></li>
  </ul></li>
  <li><a href="#pie-charts-4" id="toc-pie-charts-4" class="nav-link" data-scroll-target="#pie-charts-4"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-your-turn" id="toc-improvements-your-turn" class="nav-link" data-scroll-target="#improvements-your-turn">Improvements: Your Turn</a></li>
  </ul></li>
  <li><a href="#pie-charts-5" id="toc-pie-charts-5" class="nav-link" data-scroll-target="#pie-charts-5"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-your-turn-1" id="toc-improvements-your-turn-1" class="nav-link" data-scroll-target="#improvements-your-turn-1">Improvements: Your Turn</a></li>
  </ul></li>
  <li><a href="#pie-charts-6" id="toc-pie-charts-6" class="nav-link" data-scroll-target="#pie-charts-6"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#more-improvements" id="toc-more-improvements" class="nav-link" data-scroll-target="#more-improvements">More Improvements</a></li>
  </ul></li>
  <li><a href="#pie-charts-7" id="toc-pie-charts-7" class="nav-link" data-scroll-target="#pie-charts-7"><span style="color:white;">Pie Charts</span></a>
  <ul class="collapse">
  <li><a href="#more-improvements-1" id="toc-more-improvements-1" class="nav-link" data-scroll-target="#more-improvements-1">More Improvements</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts" id="toc-stacked-bar-charts" class="nav-link" data-scroll-target="#stacked-bar-charts"><span style="color:white;">Stacked Bar Charts</span></a></li>
  <li><a href="#stacked-bar-charts-1" id="toc-stacked-bar-charts-1" class="nav-link" data-scroll-target="#stacked-bar-charts-1"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#basic-syntax-1" id="toc-basic-syntax-1" class="nav-link" data-scroll-target="#basic-syntax-1">Basic Syntax</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts-2" id="toc-stacked-bar-charts-2" class="nav-link" data-scroll-target="#stacked-bar-charts-2"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-labels-and-scales-exercise" id="toc-improvements-color-labels-and-scales-exercise" class="nav-link" data-scroll-target="#improvements-color-labels-and-scales-exercise">Improvements: Color, Labels, and Scales Exercise</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts-3" id="toc-stacked-bar-charts-3" class="nav-link" data-scroll-target="#stacked-bar-charts-3"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-labels-and-scales-exercise-1" id="toc-improvements-color-labels-and-scales-exercise-1" class="nav-link" data-scroll-target="#improvements-color-labels-and-scales-exercise-1">Improvements: Color, Labels, and Scales Exercise</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts-4" id="toc-stacked-bar-charts-4" class="nav-link" data-scroll-target="#stacked-bar-charts-4"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-directly-label-1" id="toc-improvements-directly-label-1" class="nav-link" data-scroll-target="#improvements-directly-label-1">Improvements: Directly label</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts-5" id="toc-stacked-bar-charts-5" class="nav-link" data-scroll-target="#stacked-bar-charts-5"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-theme-elements-exercise" id="toc-improvements-theme-elements-exercise" class="nav-link" data-scroll-target="#improvements-theme-elements-exercise">Improvements: Theme Elements Exercise</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts-6" id="toc-stacked-bar-charts-6" class="nav-link" data-scroll-target="#stacked-bar-charts-6"><span style="color:white;">Stacked Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-theme-elements-exercise-1" id="toc-improvements-theme-elements-exercise-1" class="nav-link" data-scroll-target="#improvements-theme-elements-exercise-1">Improvements: Theme Elements Exercise</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts" id="toc-side-by-side-bar-charts" class="nav-link" data-scroll-target="#side-by-side-bar-charts"><span style="color:white;">Side-by-Side Bar Charts</span></a></li>
  <li><a href="#side-by-side-bar-charts-1" id="toc-side-by-side-bar-charts-1" class="nav-link" data-scroll-target="#side-by-side-bar-charts-1"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#basic-syntax-2" id="toc-basic-syntax-2" class="nav-link" data-scroll-target="#basic-syntax-2">Basic Syntax</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-2" id="toc-side-by-side-bar-charts-2" class="nav-link" data-scroll-target="#side-by-side-bar-charts-2"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-order" id="toc-improvements-order" class="nav-link" data-scroll-target="#improvements-order">Improvements: Order</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-3" id="toc-side-by-side-bar-charts-3" class="nav-link" data-scroll-target="#side-by-side-bar-charts-3"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-axis-labels-and-titles" id="toc-improvements-axis-labels-and-titles" class="nav-link" data-scroll-target="#improvements-axis-labels-and-titles">Improvements: Axis Labels and Titles</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-4" id="toc-side-by-side-bar-charts-4" class="nav-link" data-scroll-target="#side-by-side-bar-charts-4"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-axis-labels-and-titles-1" id="toc-improvements-axis-labels-and-titles-1" class="nav-link" data-scroll-target="#improvements-axis-labels-and-titles-1">Improvements: Axis Labels and Titles</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-5" id="toc-side-by-side-bar-charts-5" class="nav-link" data-scroll-target="#side-by-side-bar-charts-5"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-theme-elements-exercise-2" id="toc-improvements-theme-elements-exercise-2" class="nav-link" data-scroll-target="#improvements-theme-elements-exercise-2">Improvements: Theme Elements Exercise</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-6" id="toc-side-by-side-bar-charts-6" class="nav-link" data-scroll-target="#side-by-side-bar-charts-6"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-theme-elements-exercise-3" id="toc-improvements-theme-elements-exercise-3" class="nav-link" data-scroll-target="#improvements-theme-elements-exercise-3">Improvements: Theme Elements Exercise</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-7" id="toc-side-by-side-bar-charts-7" class="nav-link" data-scroll-target="#side-by-side-bar-charts-7"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-colors" id="toc-improvements-colors" class="nav-link" data-scroll-target="#improvements-colors">Improvements: Colors</a></li>
  </ul></li>
  <li><a href="#side-by-side-bar-charts-8" id="toc-side-by-side-bar-charts-8" class="nav-link" data-scroll-target="#side-by-side-bar-charts-8"><span style="color:white;">Side-by-Side Bar Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-colors-1" id="toc-improvements-colors-1" class="nav-link" data-scroll-target="#improvements-colors-1">Improvements: Colors</a></li>
  </ul></li>
  <li><a href="#bar-charts-and-density-across-continuous-variables" id="toc-bar-charts-and-density-across-continuous-variables" class="nav-link" data-scroll-target="#bar-charts-and-density-across-continuous-variables"><span style="color:black;">Bar Charts and Density Across Continuous Variables</span></a></li>
  <li><a href="#bar-charts-and-density-across-continuous-variables-1" id="toc-bar-charts-and-density-across-continuous-variables-1" class="nav-link" data-scroll-target="#bar-charts-and-density-across-continuous-variables-1"><span style="color:black;">Bar Charts and Density Across Continuous Variables</span></a></li>
  <li><a href="#stacked-area-charts" id="toc-stacked-area-charts" class="nav-link" data-scroll-target="#stacked-area-charts"><span style="color:black;">Stacked Area Charts</span></a></li>
  <li><a href="#stacked-area-charts-1" id="toc-stacked-area-charts-1" class="nav-link" data-scroll-target="#stacked-area-charts-1"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color" id="toc-improvements-color" class="nav-link" data-scroll-target="#improvements-color">Improvements: Color</a></li>
  </ul></li>
  <li><a href="#stacked-area-charts-2" id="toc-stacked-area-charts-2" class="nav-link" data-scroll-target="#stacked-area-charts-2"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-1" id="toc-improvements-color-1" class="nav-link" data-scroll-target="#improvements-color-1">Improvements: Color</a></li>
  </ul></li>
  <li><a href="#stacked-area-charts-3" id="toc-stacked-area-charts-3" class="nav-link" data-scroll-target="#stacked-area-charts-3"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-labels" id="toc-improvements-color-labels" class="nav-link" data-scroll-target="#improvements-color-labels">Improvements: Color Labels</a></li>
  </ul></li>
  <li><a href="#stacked-area-charts-4" id="toc-stacked-area-charts-4" class="nav-link" data-scroll-target="#stacked-area-charts-4"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-labels-1" id="toc-improvements-color-labels-1" class="nav-link" data-scroll-target="#improvements-color-labels-1">Improvements: Color Labels</a></li>
  </ul></li>
  <li><a href="#stacked-area-charts-5" id="toc-stacked-area-charts-5" class="nav-link" data-scroll-target="#stacked-area-charts-5"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-labels-titles-and-themes" id="toc-improvements-labels-titles-and-themes" class="nav-link" data-scroll-target="#improvements-labels-titles-and-themes">Improvements: Labels, Titles, and Themes</a></li>
  </ul></li>
  <li><a href="#stacked-area-charts-6" id="toc-stacked-area-charts-6" class="nav-link" data-scroll-target="#stacked-area-charts-6"><span style="color:black;">Stacked Area Charts</span></a>
  <ul class="collapse">
  <li><a href="#improvements-labels-and-title" id="toc-improvements-labels-and-title" class="nav-link" data-scroll-target="#improvements-labels-and-title">Improvements: Labels and Title</a></li>
  </ul></li>
  <li><a href="#total-density-plots" id="toc-total-density-plots" class="nav-link" data-scroll-target="#total-density-plots"><span style="color:black;">Total Density Plots</span></a></li>
  <li><a href="#total-density-plots-1" id="toc-total-density-plots-1" class="nav-link" data-scroll-target="#total-density-plots-1"><span style="color:black;">Total Density Plots</span></a></li>
  <li><a href="#total-density-plots-2" id="toc-total-density-plots-2" class="nav-link" data-scroll-target="#total-density-plots-2"><span style="color:black;">Total Density Plots</span></a></li>
  <li><a href="#total-density-plots-3" id="toc-total-density-plots-3" class="nav-link" data-scroll-target="#total-density-plots-3"><span style="color:black;">Total Density Plots</span></a></li>
  <li><a href="#total-density-plots-4" id="toc-total-density-plots-4" class="nav-link" data-scroll-target="#total-density-plots-4"><span style="color:black;">Total Density Plots</span></a></li>
  <li><a href="#nested-proportions" id="toc-nested-proportions" class="nav-link" data-scroll-target="#nested-proportions"><span style="color:white;">Nested Proportions</span></a></li>
  <li><a href="#nested-proportions-1" id="toc-nested-proportions-1" class="nav-link" data-scroll-target="#nested-proportions-1"><span style="color:white;">Nested Proportions</span></a></li>
  <li><a href="#mosaic-plots" id="toc-mosaic-plots" class="nav-link" data-scroll-target="#mosaic-plots"><span style="color:white;">Mosaic Plots</span></a></li>
  <li><a href="#mosaic-plots-1" id="toc-mosaic-plots-1" class="nav-link" data-scroll-target="#mosaic-plots-1"><span style="color:white;">Mosaic Plots</span></a>
  <ul class="collapse">
  <li><a href="#wrangle-the-data" id="toc-wrangle-the-data" class="nav-link" data-scroll-target="#wrangle-the-data">Wrangle the Data</a></li>
  </ul></li>
  <li><a href="#mosaic-plots-2" id="toc-mosaic-plots-2" class="nav-link" data-scroll-target="#mosaic-plots-2"><span style="color:white;">Mosaic Plots</span></a></li>
  <li><a href="#treemap" id="toc-treemap" class="nav-link" data-scroll-target="#treemap"><span style="color:white;">Treemap</span></a></li>
  <li><a href="#treemap-1" id="toc-treemap-1" class="nav-link" data-scroll-target="#treemap-1"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#wrangle-the-data-1" id="toc-wrangle-the-data-1" class="nav-link" data-scroll-target="#wrangle-the-data-1">Wrangle the Data</a></li>
  </ul></li>
  <li><a href="#treemap-2" id="toc-treemap-2" class="nav-link" data-scroll-target="#treemap-2"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#basic" id="toc-basic" class="nav-link" data-scroll-target="#basic">Basic</a></li>
  </ul></li>
  <li><a href="#treemap-3" id="toc-treemap-3" class="nav-link" data-scroll-target="#treemap-3"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#improvements-remove-legend-and-add-labels" id="toc-improvements-remove-legend-and-add-labels" class="nav-link" data-scroll-target="#improvements-remove-legend-and-add-labels">Improvements: Remove Legend and Add Labels</a></li>
  </ul></li>
  <li><a href="#treemap-4" id="toc-treemap-4" class="nav-link" data-scroll-target="#treemap-4"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#improvements-add-subgroup-text" id="toc-improvements-add-subgroup-text" class="nav-link" data-scroll-target="#improvements-add-subgroup-text">Improvements: Add Subgroup Text</a></li>
  </ul></li>
  <li><a href="#treemap-5" id="toc-treemap-5" class="nav-link" data-scroll-target="#treemap-5"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#improvements-color-palette" id="toc-improvements-color-palette" class="nav-link" data-scroll-target="#improvements-color-palette">Improvements: Color Palette</a></li>
  </ul></li>
  <li><a href="#treemap-6" id="toc-treemap-6" class="nav-link" data-scroll-target="#treemap-6"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#improvements-group-and-subgroup-borders-text-color" id="toc-improvements-group-and-subgroup-borders-text-color" class="nav-link" data-scroll-target="#improvements-group-and-subgroup-borders-text-color">Improvements: Group and Subgroup Borders + Text Color</a></li>
  </ul></li>
  <li><a href="#treemap-7" id="toc-treemap-7" class="nav-link" data-scroll-target="#treemap-7"><span style="color:white;">Treemap</span></a>
  <ul class="collapse">
  <li><a href="#improvements-title" id="toc-improvements-title" class="nav-link" data-scroll-target="#improvements-title">Improvements: Title</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#activity-lab-time" id="toc-activity-lab-time" class="nav-link" data-scroll-target="#activity-lab-time">Activity / Lab Time</a>
  <ul class="collapse">
  <li><a href="#activity-lab-time-if-time" id="toc-activity-lab-time-if-time" class="nav-link" data-scroll-target="#activity-lab-time-if-time">Activity / Lab Time (If time)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 3: Proportions</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Emorie D Beck </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">

</div>
<section id="quick-review" class="level1">
<h1>Quick Review</h1>
<section id="review" class="level2">
<h2 class="anchored" data-anchor-id="review">Review</h2>
<section id="what-are-the-core-elements-of-ggplot2-grammar" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-core-elements-of-ggplot2-grammar">What are the core elements of ggplot2 grammar?</h3>
<p>From last week:</p>
<div class="columns">
<div class="column">
<ul>
<li><strong>Mappings</strong>: base layer
<ul>
<li><code>ggplot()</code> and <code>aes()</code></li>
</ul></li>
<li><strong>Scales</strong>: control and modify your mappings
<ul>
<li>e.g., <code>scale_x_continuous()</code> and <code>scale_fill_manual()</code></li>
</ul></li>
<li><strong>Geoms</strong>: plot elements
<ul>
<li>e.g., <code>geom_point()</code> and <code>geom_line()</code></li>
</ul></li>
</ul>
</div><div class="column">
<ul>
<li><strong>Facets</strong>: panel your plot
<ul>
<li><code>facet_wrap()</code> and <code>facet_grid()</code></li>
</ul></li>
<li><strong>Themes</strong>: style your figure
<ul>
<li>Built-in: e.g., <code>theme_classic()</code></li>
<li>Manual: <code>theme()</code> (<code>legend</code>, <code>strip</code>, <code>axis</code>, <code>plot</code>, <code>panel</code>)</li>
</ul></li>
</ul>
</div>
</div>
</section>
</section>
<section id="quick-review-1" class="level2">
<h2 class="anchored" data-anchor-id="quick-review-1">Quick Review</h2>
<section id="colorblindness-and-accessible-plots" class="level3">
<h3 class="anchored" data-anchor-id="colorblindness-and-accessible-plots">Colorblindness and accessible plots</h3>
<ul>
<li>Adding in a colorblind-friendly palette from <a href="https://www.nature.com/articles/nmeth.1618">Wong (2011)</a></li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cbsafe_pal <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name, <span class="sc">~</span>rgb</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"black"</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"sky blue"</span>, <span class="fu">c</span>(<span class="dv">86</span>, <span class="dv">180</span>, <span class="dv">233</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"bluish green"</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">158</span>, <span class="dv">115</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"yellow"</span>, <span class="fu">c</span>(<span class="dv">240</span>, <span class="dv">228</span>, <span class="dv">66</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"orange"</span>, <span class="fu">c</span>(<span class="dv">230</span>, <span class="dv">159</span>, <span class="dv">0</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"blue"</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">114</span>, <span class="dv">178</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"vermillion"</span>, <span class="fu">c</span>(<span class="dv">213</span>, <span class="dv">94</span>, <span class="dv">0</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  , <span class="st">"reddish purple"</span>, <span class="fu">c</span>(<span class="dv">204</span>, <span class="dv">121</span>, <span class="dv">167</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hex =</span> <span class="fu">map_chr</span>(rgb, <span class="cf">function</span>(x) <span class="fu">rgb</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>], <span class="at">maxColorValue =</span> <span class="dv">255</span>)))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>cbsafe_pal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  name           rgb       hex    
  &lt;chr&gt;          &lt;list&gt;    &lt;chr&gt;  
1 black          &lt;dbl [3]&gt; #000000
2 sky blue       &lt;dbl [3]&gt; #56B4E9
3 bluish green   &lt;dbl [3]&gt; #009E73
4 yellow         &lt;dbl [3]&gt; #F0E442
5 orange         &lt;dbl [3]&gt; #E69F00
6 blue           &lt;dbl [3]&gt; #0072B2
7 vermillion     &lt;dbl [3]&gt; #D55E00
8 reddish purple &lt;dbl [3]&gt; #CC79A7</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="proportions" class="level1">
<h1>Proportions</h1>
<section id="visualizating-proportions" class="level2">
<h2 class="anchored" data-anchor-id="visualizating-proportions">Visualizating Proportions</h2>
<ul>
<li>Proportions are often important in our research</li>
<li>From describing sample-level differences to describing the frequency of behaviors / events / experiences, etc., we often reach toward describing amounts relative to the whole</li>
<li>But the goals we are trying to achieve are varied, which necesssitates the use of different graphics</li>
</ul>
</section>
<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ul>
<li>We will cover X kinds of ways of visualizations, all of which were covered in your readings</li>
<li>We will cover both when to use them and how to create them
<ul>
<li>Pie Charts</li>
<li>Bar Charts (Stacked)</li>
<li>Bar Charts (Side-by-Side)</li>
<li>Bar Charts and Density Across Continuous Variables</li>
<li>Mosaic Plots</li>
<li><del>Parallel Sets</del></li>
</ul></li>
</ul>
</section>
<section id="but-first-our-data" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="but-first-our-data">But First, Our Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>Today, we’ll use the teaching sample from the German Socioeconomic Panel Study (GSOEP)</li>
<li>GSOEP is an ongoing longitudinal panel study that began in 1984 (26 waves of data!)</li>
<li>~20,000 people are sampled each year</li>
<li>Samples households in Germany</li>
<li>Has additional sub-projects (e.g., innovation studies, migrant panel, etc.)</li>
<li>The data are publicly available via application</li>
</ul>
<div class="cell">

</div>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/03-week3-proportions/04-data/gsoep.RData"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>gsoep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 480,798 × 10
    year   SID SRhealth marital chldbrth   gender yearBrth mortality   job   age
   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;hvn_lb&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  1984   901       NA      NA       NA        2     1951         0    NA    33
 2  1984  1001       NA      NA       NA        2     1913         0    NA    71
 3  1984  1101       NA      NA       NA        2     1906         0    NA    78
 4  1984  1201       NA      NA       NA        1     1911         0    NA    73
 5  1984  1202       NA      NA       NA        2     1913         0    NA    71
 6  1984  1301       NA      NA       NA        2     1943         0    NA    41
 7  1984  1302       NA      NA       NA        1     1965         0    NA    19
 8  1984  1901       NA      NA       NA        2     1948         0    NA    36
 9  1984  2001       NA      NA       NA        2     1949         0    NA    35
10  1984  2002       NA      NA       NA        1     1952         0    NA    32
# ℹ 480,788 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="pie-charts" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" class="anchored" data-anchor-id="pie-charts"><span style="color:white;">Pie Charts</span></h2>
<ul>
<li>You may be wondering if you should ever use a pie chart</li>
<li>The answer is, of course, it depends</li>
<li>Pie charts are great when:
<ul>
<li>What you want to visualize is simple (e.g., basic fractions)</li>
<li>You want to clearly emphasize proportion relative to the whole</li>
<li>You have a small data set</li>
</ul></li>
</ul>
</section>
<section id="pie-charts-1" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" class="anchored" data-anchor-id="pie-charts-1"><span style="color:white;">Pie Charts</span></h2>
<ul>
<li>In our data, we have a few variables that follow this, but we’ll focus on one for pie charts:
<ul>
<li>marital status (4 groups)</li>
</ul></li>
<li><code>ggplot2</code> doesn’t specifically support pie charts</li>
<li>Why? Because it’s a layered grammar of graphics and an explicit function for it would be redundant with some of the built in coordinates
<ul>
<li>specifically, <code>coord_polar()</code></li>
</ul></li>
<li>So to make a pie chart, we’ll use <code>geom_bar() + coord_polar()</code></li>
</ul>
</section>
<section id="pie-charts-2" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" class="anchored" data-anchor-id="pie-charts-2"><span style="color:white;">Pie Charts</span></h2>
<section id="basic-syntax" class="level3">
<h3 class="anchored" data-anchor-id="basic-syntax">Basic Syntax</h3>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">group_by</span>(marital) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(</span>
<span id="cb5-6"><a href="#cb5-6"></a>    marital</span>
<span id="cb5-7"><a href="#cb5-7"></a>    , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    , <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[5,3]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pie-charts-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" data-anchor-id="pie-charts-3"><span style="color:white;">Pie Charts</span></h2>
<section id="improvements-directly-label" class="level3">
<h3 class="anchored" data-anchor-id="improvements-directly-label">Improvements: Directly label</h3>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">group_by</span>(marital) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(</span>
<span id="cb6-6"><a href="#cb6-6"></a>    marital</span>
<span id="cb6-7"><a href="#cb6-7"></a>    , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    , <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>         , <span class="at">ypos =</span> <span class="fu">cumsum</span>(prop)<span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>prop) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb6-16"><a href="#cb6-16"></a>      <span class="fu">aes</span>(<span class="at">y =</span> ypos, <span class="at">label =</span> marital)</span>
<span id="cb6-17"><a href="#cb6-17"></a>      , <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>      , <span class="at">size=</span><span class="dv">4</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>      ) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>    <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb6-21"><a href="#cb6-21"></a>    <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[4,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pie-charts-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" data-anchor-id="pie-charts-4"><span style="color:white;">Pie Charts</span></h2>
<section id="improvements-your-turn" class="level3">
<h3 class="anchored" data-anchor-id="improvements-your-turn">Improvements: Your Turn</h3>
<ol type="1">
<li>Add a color-blind friendly palette (hint: use scale_fill_manual the the palette we created earlier)</li>
<li>Remove the legend.</li>
<li>Add the percentages in each category.</li>
</ol>
</section>
</section>
<section id="pie-charts-5" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" data-anchor-id="pie-charts-5"><span style="color:white;">Pie Charts</span></h2>
<section id="improvements-your-turn-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-your-turn-1">Improvements: Your Turn</h3>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">group_by</span>(marital) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>    marital</span>
<span id="cb7-7"><a href="#cb7-7"></a>    , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    , <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>         , <span class="at">ypos =</span> <span class="fu">cumsum</span>(prop)<span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>prop) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb7-14"><a href="#cb7-14"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb7-16"><a href="#cb7-16"></a>      <span class="fu">aes</span>(<span class="at">y =</span> ypos, <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">%.1f%%"</span>, marital, prop))</span>
<span id="cb7-17"><a href="#cb7-17"></a>      , <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>      , <span class="at">size=</span><span class="dv">4</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>      ) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbsafe_pal<span class="sc">$</span>hex[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">4</span>)]) <span class="sc">+</span> </span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb7-22"><a href="#cb7-22"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[4,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pie-charts-6" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" data-anchor-id="pie-charts-6"><span style="color:white;">Pie Charts</span></h2>
<section id="more-improvements" class="level3">
<h3 class="anchored" data-anchor-id="more-improvements">More Improvements</h3>
<ul>
<li>Remember that we want to tell a story with our data. Thus, with pie charts, it often makes sense to use a color palette that varies in saturation or lightness (v. hue) with the exception of the focal category. Let’s tell a story with our plot:</li>
</ul>
<ol type="1">
<li>Add a title (hint: use the <code>labs()</code> function) to the plot that makes it clear what you want the reader to see.</li>
<li>Change the color palette so that the focal category is a different color than the other categories (which should be the same hue but at different levels of saturation or lightness).</li>
<li>Make your labels easier to see by swapping out <code>geom_text()</code> for <code>geom_label()</code>.</li>
</ol>
</section>
</section>
<section id="pie-charts-7" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/blue-top.png" data-background-size="100%" data-anchor-id="pie-charts-7"><span style="color:white;">Pie Charts</span></h2>
<section id="more-improvements-1" class="level3">
<h3 class="anchored" data-anchor-id="more-improvements-1">More Improvements</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[4,4]">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">group_by</span>(marital) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>         , <span class="at">ypos =</span> <span class="fu">cumsum</span>(prop)<span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>prop) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="fu">geom_label</span>(</span>
<span id="cb8-12"><a href="#cb8-12"></a>      <span class="fu">aes</span>(<span class="at">y =</span> ypos, <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">%.1f%%"</span>, marital, prop))</span>
<span id="cb8-13"><a href="#cb8-13"></a>      , <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>      , <span class="at">size =</span> <span class="dv">6</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>      , <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">"Greens"</span>)[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)]), <span class="st">"grey60"</span>)) <span class="sc">+</span> </span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="fu">labs</span>(</span>
<span id="cb8-19"><a href="#cb8-19"></a>      <span class="at">title =</span> <span class="st">"In 2009, the majority of GSOEP participants</span><span class="sc">\n</span><span class="st">were or had been married/partnered"</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    ) <span class="sc">+</span> </span>
<span id="cb8-21"><a href="#cb8-21"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="fu">theme</span>(</span>
<span id="cb8-23"><a href="#cb8-23"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>      , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold.italic"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.4</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb8-25"><a href="#cb8-25"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" class="anchored" data-anchor-id="stacked-bar-charts"><span style="color:white;">Stacked Bar Charts</span></h2>
<ul>
<li>Like pie charts, stacked bar charts have their time and place</li>
<li>In particular:
<ul>
<li>Show proportions relative to the total</li>
<li>Can be used to show changes over time</li>
</ul></li>
<li>To demonstrate, let’s look at marital status across emerging adulthood (18-26) where we expect changes in the proportion of martial status across time.</li>
</ul>
</section>
<section id="stacked-bar-charts-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" data-anchor-id="stacked-bar-charts-1"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="basic-syntax-1" class="level3">
<h3 class="anchored" data-anchor-id="basic-syntax-1">Basic Syntax</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">26</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">group_by</span>(age, marital) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="at">marital =</span> <span class="fu">factor</span>(</span>
<span id="cb9-8"><a href="#cb9-8"></a>      marital</span>
<span id="cb9-9"><a href="#cb9-9"></a>      , <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>      , <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)</span>
<span id="cb9-11"><a href="#cb9-11"></a>      )</span>
<span id="cb9-12"><a href="#cb9-12"></a>    , <span class="at">age =</span> <span class="fu">factor</span>(age)</span>
<span id="cb9-13"><a href="#cb9-13"></a>    , <span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)</span>
<span id="cb9-14"><a href="#cb9-14"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> <span class="co"># geom_bar(stat = "identity", color = "black")</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[5,3.5]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" data-anchor-id="stacked-bar-charts-2"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="improvements-color-labels-and-scales-exercise" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-labels-and-scales-exercise">Improvements: Color, Labels, and Scales Exercise</h3>
<p>Let’s improve how this looks. Let’s start by adjusting the color and labels, like last time. Do the following:</p>
<ol type="1">
<li>Change the color palette to tell the story you see in the data.</li>
<li>Use <code>scale_y_continuous()</code> to improve the labels on the y-axis (i.e.&nbsp;change them to intuitive percentages)</li>
<li>Use <code>labs()</code> to add/improve the <code>title</code>, <code>subtitle</code>, <code>x</code>, and <code>y</code> labels on the plot</li>
<li>Remove the title for fill (hint: use the <code>labs()</code> function) and move the legend to the bottom</li>
</ol>
</section>
</section>
<section id="stacked-bar-charts-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" data-anchor-id="stacked-bar-charts-3"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="improvements-color-labels-and-scales-exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-labels-and-scales-exercise-1">Improvements: Color, Labels, and Scales Exercise</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[5,3.5]">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">26</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">group_by</span>(age, marital) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="at">marital =</span> <span class="fu">factor</span>(</span>
<span id="cb10-8"><a href="#cb10-8"></a>      marital</span>
<span id="cb10-9"><a href="#cb10-9"></a>      , <span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a>      , <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>))</span>
<span id="cb10-11"><a href="#cb10-11"></a>      )</span>
<span id="cb10-12"><a href="#cb10-12"></a>    , <span class="at">age =</span> <span class="fu">factor</span>(age)</span>
<span id="cb10-13"><a href="#cb10-13"></a>    , <span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)</span>
<span id="cb10-14"><a href="#cb10-14"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb10-16"><a href="#cb10-16"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb10-17"><a href="#cb10-17"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey80"</span>,<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">"Greens"</span>)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])) <span class="sc">+</span> </span>
<span id="cb10-18"><a href="#cb10-18"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb10-19"><a href="#cb10-19"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>      , <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">25</span>)</span>
<span id="cb10-21"><a href="#cb10-21"></a>      , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"100%"</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>      ) <span class="sc">+</span> </span>
<span id="cb10-23"><a href="#cb10-23"></a>    <span class="fu">labs</span>(</span>
<span id="cb10-24"><a href="#cb10-24"></a>      <span class="at">x =</span> <span class="st">"Age"</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>      , <span class="at">y =</span> <span class="st">"Percent of Sample"</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>      , <span class="at">title =</span> <span class="st">"Rates of relationships increase in emerging adulthood"</span></span>
<span id="cb10-27"><a href="#cb10-27"></a>      , <span class="at">subtitle =</span> <span class="st">"But most remain unpartnered by 26"</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>      , <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb10-29"><a href="#cb10-29"></a>      ) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb10-31"><a href="#cb10-31"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[5,3.5]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" data-anchor-id="stacked-bar-charts-4"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="improvements-directly-label-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-directly-label-1">Improvements: Directly label</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">26</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">group_by</span>(age, marital) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)))</span>
<span id="cb11-7"><a href="#cb11-7"></a>         , <span class="at">age =</span> <span class="fu">factor</span>(age)</span>
<span id="cb11-8"><a href="#cb11-8"></a>         , <span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey80"</span>,<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">"Greens"</span>)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])) <span class="sc">+</span> </span>
<span id="cb11-12"><a href="#cb11-12"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb11-13"><a href="#cb11-13"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a>      , <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">25</span>)</span>
<span id="cb11-15"><a href="#cb11-15"></a>      , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"100%"</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a>      ) <span class="sc">+</span> </span>
<span id="cb11-17"><a href="#cb11-17"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"26"</span>, <span class="at">y =</span> .<span class="dv">60</span>, <span class="at">label =</span> <span class="st">"Never Married"</span>, <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span> </span>
<span id="cb11-18"><a href="#cb11-18"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"26"</span>, <span class="at">y =</span> .<span class="dv">13</span>, <span class="at">label =</span> <span class="st">"Married"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb11-19"><a href="#cb11-19"></a>    <span class="fu">labs</span>(</span>
<span id="cb11-20"><a href="#cb11-20"></a>      <span class="at">x =</span> <span class="st">"Age"</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>      , <span class="at">y =</span> <span class="st">"Percent of Sample"</span></span>
<span id="cb11-22"><a href="#cb11-22"></a>      , <span class="at">title =</span> <span class="st">"Rates of relationships increase in emerging adulthood"</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>      , <span class="at">subtitle =</span> <span class="st">"But most remain unpartnered by 26"</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>      , <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>      ) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb11-27"><a href="#cb11-27"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts-5" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" class="anchored" data-anchor-id="stacked-bar-charts-5"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="improvements-theme-elements-exercise" class="level3">
<h3 class="anchored" data-anchor-id="improvements-theme-elements-exercise">Improvements: Theme Elements Exercise</h3>
<ol type="1">
<li>Bold axis text and increase size</li>
<li>Bold axis titles and increase size</li>
<li>Bold title and subtitle and center (hint, you may also need to wrap the title text using <code>\n</code>)</li>
</ol>
</section>
</section>
<section id="stacked-bar-charts-6" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/green-top.png" data-background-size="100%" data-anchor-id="stacked-bar-charts-6"><span style="color:white;">Stacked Bar Charts</span></h2>
<section id="improvements-theme-elements-exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-theme-elements-exercise-1">Improvements: Theme Elements Exercise</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">26</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">group_by</span>(age, marital) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>)))</span>
<span id="cb12-7"><a href="#cb12-7"></a>         , <span class="at">age =</span> <span class="fu">factor</span>(age)</span>
<span id="cb12-8"><a href="#cb12-8"></a>         , <span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb12-11"><a href="#cb12-11"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey80"</span>,<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">"Greens"</span>)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="#cb12-12"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb12-13"><a href="#cb12-13"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a>      , <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">25</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>      , <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"100%"</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a>      ) <span class="sc">+</span> </span>
<span id="cb12-17"><a href="#cb12-17"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"26"</span>, <span class="at">y =</span> .<span class="dv">60</span>, <span class="at">label =</span> <span class="st">"Never Married"</span>, <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span> </span>
<span id="cb12-18"><a href="#cb12-18"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"26"</span>, <span class="at">y =</span> .<span class="dv">13</span>, <span class="at">label =</span> <span class="st">"Married"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb12-19"><a href="#cb12-19"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-20"><a href="#cb12-20"></a>      <span class="at">x =</span> <span class="st">"Age"</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>      , <span class="at">y =</span> <span class="st">"Percent of Sample"</span></span>
<span id="cb12-22"><a href="#cb12-22"></a>      , <span class="at">title =</span> <span class="st">"Rates of relationships increase in</span><span class="sc">\n</span><span class="st">emerging adulthood"</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>      , <span class="at">subtitle =</span> <span class="st">"But most remain unpartnered by 26"</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>      , <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>      ) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb12-27"><a href="#cb12-27"></a>    <span class="fu">theme</span>(</span>
<span id="cb12-28"><a href="#cb12-28"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>      , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb12-30"><a href="#cb12-30"></a>      , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb12-31"><a href="#cb12-31"></a>      , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a>      , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb12-33"><a href="#cb12-33"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="side-by-side-bar-charts" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" class="anchored" data-anchor-id="side-by-side-bar-charts"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<ul>
<li>Stacked bar charts are great for showing sequences but can make it difficult to compare <em>within</em> a stack</li>
<li>Side-by-side bar charts make it much easier to compare across categories and work well when broken into many categories</li>
<li>But they can be difficult to understand across sequences</li>
<li>To demonstrate, let’s look at marriage rates across three waves</li>
</ul>
</section>
<section id="side-by-side-bar-charts-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-1"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="basic-syntax-2" class="level3">
<h3 class="anchored" data-anchor-id="basic-syntax-2">Basic Syntax</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>, <span class="dv">2015</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">group_by</span>(year, marital) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>, <span class="st">"Never Married"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> <span class="co"># geom_bar(stat = "identity", color = "black", position =</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="side-by-side-bar-charts-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-2"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-order" class="level3">
<h3 class="anchored" data-anchor-id="improvements-order">Improvements: Order</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>, <span class="dv">2015</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">group_by</span>(year, marital) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Never Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb14-10"><a href="#cb14-10"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="side-by-side-bar-charts-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-3"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-axis-labels-and-titles" class="level3">
<h3 class="anchored" data-anchor-id="improvements-axis-labels-and-titles">Improvements: Axis Labels and Titles</h3>
<p>We could label the bars, but let’s label the axes instead. To do so:</p>
<ol type="1">
<li>Use <code>theme(axis.text.x = element_text()</code>) to adjust the angle of the x-axis labels (hint: use <code>angle</code> and <code>hjust</code>).</li>
<li>Adjust the y-axis scale using <code>scale_y_continuous()</code> to interpretable percentages.</li>
<li>Using <code>labs()</code>:</li>
</ol>
<ul>
<li>Remove the x-axis title</li>
<li>Change the y-axis title to a complete phrase</li>
<li>Add an informative title</li>
</ul>
</section>
</section>
<section id="side-by-side-bar-charts-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-4"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-axis-labels-and-titles-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-axis-labels-and-titles-1">Improvements: Axis Labels and Titles</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>, <span class="dv">2015</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">group_by</span>(year, marital) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Never Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb15-11"><a href="#cb15-11"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">7</span>, .<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"20%"</span>, <span class="st">"40%"</span>, <span class="st">"60%"</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a>    ) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="fu">labs</span>(</span>
<span id="cb15-15"><a href="#cb15-15"></a>      <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb15-16"><a href="#cb15-16"></a>      , <span class="at">y =</span> <span class="st">"Percentage of Participants"</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>      , <span class="at">title =</span> <span class="st">"Marital Status Has Remained Consistent Throughout the 21st Century"</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>      ) <span class="sc">+</span> </span>
<span id="cb15-19"><a href="#cb15-19"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb15-20"><a href="#cb15-20"></a>    <span class="fu">theme</span>(</span>
<span id="cb15-21"><a href="#cb15-21"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb15-23"><a href="#cb15-23"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="side-by-side-bar-charts-5" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-5"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-theme-elements-exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="improvements-theme-elements-exercise-2">Improvements: Theme Elements Exercise</h3>
<p>As with the last plot type, let’s use theme() to improve the appearance of our plot. Do the following:</p>
<ol type="1">
<li>Bold axis text and increase size</li>
<li>Bold axis titles and increase size</li>
<li>Bold title and center (hint, you may also need to wrap the title text using <code>\n</code>)</li>
<li>Change the background color of the facet labels (hint: use <code>theme(strip.background = element_rect(fill = [your argument]))</code>. Note that if you use a dark color, you will also have to change the text color.)</li>
</ol>
</section>
</section>
<section id="side-by-side-bar-charts-6" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-6"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-theme-elements-exercise-3" class="level3">
<h3 class="anchored" data-anchor-id="improvements-theme-elements-exercise-3">Improvements: Theme Elements Exercise</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>, <span class="dv">2015</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">group_by</span>(year, marital) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Never Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb16-11"><a href="#cb16-11"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">7</span>, .<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"20%"</span>, <span class="st">"40%"</span>, <span class="st">"60%"</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a>    ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb16-14"><a href="#cb16-14"></a>    <span class="fu">labs</span>(</span>
<span id="cb16-15"><a href="#cb16-15"></a>      <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>      , <span class="at">y =</span> <span class="st">"Percentage of Participants"</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>      , <span class="at">title =</span> <span class="st">"Marital Status Has Remained Consistent</span><span class="sc">\n</span><span class="st">Throughout the 21st Century"</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>      ) <span class="sc">+</span> </span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb16-20"><a href="#cb16-20"></a>    <span class="fu">theme</span>(</span>
<span id="cb16-21"><a href="#cb16-21"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>      , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb16-23"><a href="#cb16-23"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>))</span>
<span id="cb16-24"><a href="#cb16-24"></a>      , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb16-25"><a href="#cb16-25"></a>      , <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb16-27"><a href="#cb16-27"></a>      , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb16-28"><a href="#cb16-28"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="side-by-side-bar-charts-7" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" class="anchored" data-anchor-id="side-by-side-bar-charts-7"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-colors" class="level3">
<h3 class="anchored" data-anchor-id="improvements-colors">Improvements: Colors</h3>
<p>Exercise:</p>
<ul>
<li>Improve the colors by making them:
<ul>
<li>Colorblind-friendly</li>
<li>Match the goal of the plot (see title)</li>
</ul></li>
</ul>
</section>
</section>
<section id="side-by-side-bar-charts-8" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/purple-top.png" data-background-size="100%" data-anchor-id="side-by-side-bar-charts-8"><span style="color:white;">Side-by-Side Bar Charts</span></h2>
<section id="improvements-colors-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-colors-1">Improvements: Colors</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span>, <span class="dv">2015</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(marital)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">group_by</span>(year, marital) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Never Married"</span>, <span class="st">"Separated"</span>, <span class="st">"Widowed"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital, <span class="at">y =</span> prop, <span class="at">fill =</span> marital)) <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb17-11"><a href="#cb17-11"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">7</span>, .<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"20%"</span>, <span class="st">"40%"</span>, <span class="st">"60%"</span>)</span>
<span id="cb17-12"><a href="#cb17-12"></a>    ) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbsafe_pal<span class="sc">$</span>hex[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="fu">labs</span>(</span>
<span id="cb17-16"><a href="#cb17-16"></a>      <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb17-17"><a href="#cb17-17"></a>      , <span class="at">y =</span> <span class="st">"Percentage of Participants"</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>      , <span class="at">title =</span> <span class="st">"Marital Status Has Remained Consistent</span><span class="sc">\n</span><span class="st">Throughout the 21st Century"</span></span>
<span id="cb17-19"><a href="#cb17-19"></a>      ) <span class="sc">+</span> </span>
<span id="cb17-20"><a href="#cb17-20"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb17-21"><a href="#cb17-21"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-22"><a href="#cb17-22"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>      , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb17-24"><a href="#cb17-24"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>))</span>
<span id="cb17-25"><a href="#cb17-25"></a>      , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb17-26"><a href="#cb17-26"></a>      , <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb17-27"><a href="#cb17-27"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb17-28"><a href="#cb17-28"></a>      , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb17-29"><a href="#cb17-29"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="bar-charts-and-density-across-continuous-variables" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" class="anchored" data-anchor-id="bar-charts-and-density-across-continuous-variables"><span style="color:black;">Bar Charts and Density Across Continuous Variables</span></h2>
<ul>
<li>One challenge with stacked bar charts is that when there are more than two categories, it can be very difficult to track the visualized trend</li>
<li>Relative to side-by-side bar charts, it’s easy to see any category relative to the total but somewhat more difficult to also account for differing numbers of people in different categories or across time</li>
<li>One possible solution to this is to look at densities across time and groups or relative to the total</li>
<li>Let’s do both now</li>
</ul>
</section>
<section id="bar-charts-and-density-across-continuous-variables-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="bar-charts-and-density-across-continuous-variables-1"><span style="color:black;">Bar Charts and Density Across Continuous Variables</span></h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(SRhealth)) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(</span>
<span id="cb18-6"><a href="#cb18-6"></a>    SRhealth</span>
<span id="cb18-7"><a href="#cb18-7"></a>    , <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>    , <span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> SRhealth)) <span class="sc">+</span> </span>
<span id="cb18-13"><a href="#cb18-13"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbsafe_pal<span class="sc">$</span>hex[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="stacked-area-charts" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts"><span style="color:black;">Stacked Area Charts</span></h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(</span>
<span id="cb19-6"><a href="#cb19-6"></a>    SRhealth</span>
<span id="cb19-7"><a href="#cb19-7"></a>    , <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a>    , <span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)</span>
<span id="cb19-9"><a href="#cb19-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> SRhealth)) <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13"></a>    <span class="fu">geom_area</span>() <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="stacked-area-charts-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts-1"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-color" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color">Improvements: Color</h3>
<p>Let’s improve the coloring of this figure. Since we have ordinal data, we want these to be a somewhat coherent gradient to communicate amount. But we don’t want to a full gradient because it’s ordinal!</p>
<ol type="1">
<li>Apply the built-in viridis scale (hint: it’s a variant of <code>scale_fill_viridis_[type]()</code>).</li>
<li>Add boundaries to the areas (hint: use white) and reduce the intensity of the colors (hint: use alpha)</li>
</ol>
</section>
</section>
<section id="stacked-area-charts-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts-2"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-color-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-1">Improvements: Color</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(</span>
<span id="cb20-6"><a href="#cb20-6"></a>    SRhealth</span>
<span id="cb20-7"><a href="#cb20-7"></a>    , <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a>    , <span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> SRhealth)) <span class="sc">+</span> </span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb20-14"><a href="#cb20-14"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-area-charts-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts-3"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-color-labels" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-labels">Improvements: Color Labels</h3>
<div class="columns">
<div class="column">
<p>Remember, legends tax working memory, and these plots are not the exception to the rule. Let’s add the labels to the plot directly using annotate(). (Note, we could also use geom_text() but the setup would be a pain and dubiously worth the hassle.)</p>
<ul>
<li>The <a href="https://ggplot2.tidyverse.org/reference/annotate.html"><code>annotate()</code></a> function is a manual powerhouse.</li>
<li>It let’s you add <code>grobs</code> to a plot that match any kind of <code>geom</code> (e.g., lines, dots, rectangles, text, labels, and more).</li>
</ul>
</div><div class="column">
<p>Basic syntax</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  geom,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmin =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xmax =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymin =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xend =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">yend =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  ...,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">FALSE</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-area-charts-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts-4"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-color-labels-1" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-labels-1">Improvements: Color Labels</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(</span>
<span id="cb22-6"><a href="#cb22-6"></a>    SRhealth</span>
<span id="cb22-7"><a href="#cb22-7"></a>    , <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>    , <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>))</span>
<span id="cb22-9"><a href="#cb22-9"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> SRhealth)) <span class="sc">+</span> </span>
<span id="cb22-13"><a href="#cb22-13"></a>    <span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">85</span>, <span class="at">y =</span> .<span class="dv">95</span>, <span class="at">label =</span> <span class="st">"Bad"</span>         , <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-15"><a href="#cb22-15"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">75</span>, <span class="at">y =</span> .<span class="dv">80</span>, <span class="at">label =</span> <span class="st">"Poor"</span>        , <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-16"><a href="#cb22-16"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">62</span>, <span class="at">y =</span> .<span class="dv">55</span>, <span class="at">label =</span> <span class="st">"Satisfactory"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-17"><a href="#cb22-17"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">3</span> , <span class="at">label =</span> <span class="st">"Good"</span>        , <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-18"><a href="#cb22-18"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">30</span>, <span class="at">y =</span> .<span class="dv">07</span>, <span class="at">label =</span> <span class="st">"Very Good"</span>   , <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb22-21"><a href="#cb22-21"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stacked-area-charts-5" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" class="anchored" data-anchor-id="stacked-area-charts-5"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-labels-titles-and-themes" class="level3">
<h3 class="anchored" data-anchor-id="improvements-labels-titles-and-themes">Improvements: Labels, Titles, and Themes</h3>
<p>Exercise:</p>
<ol type="1">
<li>Add plot title</li>
<li>Change <code>x</code> and <code>y</code> scale labels and titles</li>
<li>Bold axis text and increase size</li>
<li>Bold axis titles and increase size</li>
<li>Bold title and center (hint, you may also need to wrap the title text using <code>\n</code>)</li>
</ol>
</section>
</section>
<section id="stacked-area-charts-6" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="stacked-area-charts-6"><span style="color:black;">Stacked Area Charts</span></h2>
<section id="improvements-labels-and-title" class="level3">
<h3 class="anchored" data-anchor-id="improvements-labels-and-title">Improvements: Labels and Title</h3>
<p>Note how much clearer this is than if I’d just plotted the mean of self-rated health across groups!!</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(SRhealth, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">fill =</span> SRhealth)) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9"></a>    <span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">85</span>, <span class="at">y =</span> .<span class="dv">95</span>, <span class="at">label =</span> <span class="st">"Bad"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">75</span>, <span class="at">y =</span> .<span class="dv">80</span>, <span class="at">label =</span> <span class="st">"Poor"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">62</span>, <span class="at">y =</span> .<span class="dv">55</span>, <span class="at">label =</span> <span class="st">"Satisfactory"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-13"><a href="#cb23-13"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label =</span> <span class="st">"Good"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">30</span>, <span class="at">y =</span> .<span class="dv">07</span>, <span class="at">label =</span> <span class="st">"Very Good"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-15"><a href="#cb23-15"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">100</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb23-16"><a href="#cb23-16"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, .<span class="dv">25</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0%"</span>, <span class="st">"25%"</span>, <span class="st">"50%"</span>, <span class="st">"75%"</span>, <span class="st">"100%"</span>)) <span class="sc">+</span> </span>
<span id="cb23-17"><a href="#cb23-17"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>    <span class="fu">labs</span>(</span>
<span id="cb23-19"><a href="#cb23-19"></a>      <span class="at">x =</span> <span class="st">"Age (Years)"</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>      , <span class="at">y =</span> <span class="st">"Percentage of Participants"</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>      , <span class="at">title =</span> <span class="st">"Levels of Self-Rated Health Decrease Across the Lifespan"</span></span>
<span id="cb23-22"><a href="#cb23-22"></a>    ) <span class="sc">+</span> </span>
<span id="cb23-23"><a href="#cb23-23"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb23-24"><a href="#cb23-24"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb23-25"><a href="#cb23-25"></a>          , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb23-26"><a href="#cb23-26"></a>          , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb23-27"><a href="#cb23-27"></a>          , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb23-28"><a href="#cb23-28"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="total-density-plots" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" class="anchored" data-anchor-id="total-density-plots"><span style="color:black;">Total Density Plots</span></h2>
<ul>
<li>Let’s revisit these data but also demonstrating how sample size changes across the lifespan</li>
<li>To do this, we need two pieces of information:
<ul>
<li>sample size in each self-rated health category at each age group</li>
<li>total in each age group</li>
</ul></li>
</ul>
</section>
<section id="total-density-plots-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="total-density-plots-1"><span style="color:black;">Total Density Plots</span></h2>
<p>Let’s start by using <code>stat_smooth()</code> to get a smoothed <code>geom_area()</code> of the total sample size onto the figure</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(SRhealth, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(n))  <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="fu">stat_smooth</span>(</span>
<span id="cb24-10"><a href="#cb24-10"></a>        <span class="fu">aes</span>(<span class="at">y =</span> total_n)</span>
<span id="cb24-11"><a href="#cb24-11"></a>        , <span class="at">geom =</span> <span class="st">'area'</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>        , <span class="at">method =</span> <span class="st">'loess'</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>        , <span class="at">span =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>        , <span class="at">alpha =</span> .<span class="dv">8</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>        , <span class="at">fill =</span> <span class="st">"grey"</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>        ) <span class="sc">+</span> </span>
<span id="cb24-17"><a href="#cb24-17"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>SRhealth) <span class="sc">+</span> </span>
<span id="cb24-18"><a href="#cb24-18"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="total-density-plots-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="total-density-plots-2"><span style="color:black;">Total Density Plots</span></h2>
<p>Now let’s add each of the ordinal values</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(SRhealth, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(n))  <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="#cb25-9"></a>    <span class="fu">stat_smooth</span>(</span>
<span id="cb25-10"><a href="#cb25-10"></a>      <span class="fu">aes</span>(<span class="at">y =</span> total_n)</span>
<span id="cb25-11"><a href="#cb25-11"></a>      , <span class="at">geom =</span> <span class="st">'area'</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>      , <span class="at">method =</span> <span class="st">'loess'</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>      , <span class="at">span =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>      , <span class="at">alpha =</span> .<span class="dv">8</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>      , <span class="at">fill =</span> <span class="st">"grey"</span></span>
<span id="cb25-16"><a href="#cb25-16"></a>      ) <span class="sc">+</span> </span>
<span id="cb25-17"><a href="#cb25-17"></a>    <span class="fu">stat_smooth</span>(</span>
<span id="cb25-18"><a href="#cb25-18"></a>        <span class="fu">aes</span>(<span class="at">fill =</span> SRhealth)</span>
<span id="cb25-19"><a href="#cb25-19"></a>        , <span class="at">geom =</span> <span class="st">'area'</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>        , <span class="at">method =</span> <span class="st">'loess'</span></span>
<span id="cb25-21"><a href="#cb25-21"></a>        , <span class="at">span =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>        , <span class="at">alpha =</span> .<span class="dv">8</span></span>
<span id="cb25-23"><a href="#cb25-23"></a>        ) <span class="sc">+</span> </span>
<span id="cb25-24"><a href="#cb25-24"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="st">"Total"</span>) <span class="sc">+</span> </span>
<span id="cb25-25"><a href="#cb25-25"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>SRhealth) <span class="sc">+</span> </span>
<span id="cb25-26"><a href="#cb25-26"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb25-27"><a href="#cb25-27"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="total-density-plots-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="total-density-plots-3"><span style="color:black;">Total Density Plots</span></h2>
<p>Let’s not belabor this too much.</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>gsoep <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SRhealth) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> age <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co"># random</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">group_by</span>(age, SRhealth) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">mutate</span>(<span class="at">SRhealth =</span> <span class="fu">factor</span>(SRhealth, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"Very good"</span>, <span class="st">"Good"</span>, <span class="st">"Satisfactory"</span>, <span class="st">"Poor"</span>, <span class="st">"Bad"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(n))  <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9"></a>    <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_n), <span class="at">geom =</span> <span class="st">'area'</span>, <span class="at">method =</span> <span class="st">'loess'</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>        , <span class="at">span =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span> </span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">fill =</span> SRhealth), <span class="at">geom =</span> <span class="st">'area'</span>, <span class="at">method =</span> <span class="st">'loess'</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>        , <span class="at">span =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb26-13"><a href="#cb26-13"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">100</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb26-14"><a href="#cb26-14"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="st">"Total"</span>) <span class="sc">+</span> </span>
<span id="cb26-16"><a href="#cb26-16"></a>    <span class="fu">labs</span>(</span>
<span id="cb26-17"><a href="#cb26-17"></a>      <span class="at">x =</span> <span class="st">"Age (Years)"</span></span>
<span id="cb26-18"><a href="#cb26-18"></a>      , <span class="at">y =</span> <span class="st">"Number of People"</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>      , <span class="at">title =</span> <span class="st">"Good Self-Rated Health Decreases Across the Lifespan"</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>      , <span class="at">subtitle =</span> <span class="st">"But bad decreases less, likely because all-cause sample drop-out"</span></span>
<span id="cb26-21"><a href="#cb26-21"></a>      ) <span class="sc">+</span> </span>
<span id="cb26-22"><a href="#cb26-22"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>SRhealth) <span class="sc">+</span> </span>
<span id="cb26-23"><a href="#cb26-23"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb26-24"><a href="#cb26-24"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb26-25"><a href="#cb26-25"></a>          , <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb26-26"><a href="#cb26-26"></a>          , <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>))</span>
<span id="cb26-27"><a href="#cb26-27"></a>          , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb26-28"><a href="#cb26-28"></a>          , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> .<span class="dv">5</span>)</span>
<span id="cb26-29"><a href="#cb26-29"></a>          , <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb26-30"><a href="#cb26-30"></a>          , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>))</span>
<span id="cb26-31"><a href="#cb26-31"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="total-density-plots-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/yellow-top.png" data-background-size="100%" data-anchor-id="total-density-plots-4"><span style="color:black;">Total Density Plots</span></h2>
<p>Perfectly fine but may not communicate what we want to show as well as other methods we’ve seen (at least in this instance).</p>
<div class="cell" data-layout-align="center" data-fig.dim="[8,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nested-proportions" class="level2" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" class="anchored" data-anchor-id="nested-proportions"><span style="color:white;">Nested Proportions</span></h2>
<ul>
<li>Sometimes, the proportions that we want to visualize are more complex and can’t just be simply binned</li>
<li>In such cases, there may be hierarchical relationships among the categories</li>
<li>Today, we’ll cover two core nested proportion plots:
<ul>
<li>Mosaic plots</li>
<li>Parallel Sets</li>
</ul></li>
<li>To do this, we’ll use two categorical variables: mortality and marital status</li>
</ul>
</section>
<section id="nested-proportions-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="nested-proportions-1"><span style="color:white;">Nested Proportions</span></h2>
<div class="columns">
<div class="column">
<ul>
<li>To do this, we’ll use 2-Digit NACE Industry Sector codes from participants’ last reported jobs in the SOEP, which I’ve broken down into 9 higher-order categories</li>
<li>This is a lot of categories, so we’ll further eventually exclude categories that don’t have at least 2% of the share of participants</li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "><table class=" lightable-classic" style="font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>2-Digit NACE Industry Sector Codes and Categories</caption>
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Category </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> Job </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Code </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="3"> Agriculture </td>
   <td style="text-align:left;"> Agriculture Hunting Rel.Serv.Activities </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Forestry Logging Rel.Service activities </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Fishing Fish Hatcheries Fish Farms </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="8"> Energy and Utilities </td>
   <td style="text-align:left;"> Mining Coal Lignite; Extraction Of Peat </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Extraction Crude Petroleum Natural Gas </td>
   <td style="text-align:right;"> 11 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Mining Of Uranium And Thorium Ores </td>
   <td style="text-align:right;"> 12 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Mining Of Metal Ores </td>
   <td style="text-align:right;"> 13 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Other Mining And Quarrying </td>
   <td style="text-align:right;"> 14 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Recycling </td>
   <td style="text-align:right;"> 37 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Electricity Gas Steam Hot Water Supply </td>
   <td style="text-align:right;"> 40 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Sewage Refuse Disposal Sanitationa.a.Re </td>
   <td style="text-align:right;"> 90 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="7"> Finance and Tech </td>
   <td style="text-align:left;"> Financ.Intermediat. Exc.Insur. Pens.Fund </td>
   <td style="text-align:right;"> 65 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Insurance Pens.Funding Ex.Compuls.SocSe </td>
   <td style="text-align:right;"> 66 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Activ.Aux.To Financial Intermediation </td>
   <td style="text-align:right;"> 67 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Computer And Related Activities </td>
   <td style="text-align:right;"> 72 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Research And Development </td>
   <td style="text-align:right;"> 73 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Other Business Activities </td>
   <td style="text-align:right;"> 74 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Industry - NEC </td>
   <td style="text-align:right;"> 96 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="24"> Manufacturing </td>
   <td style="text-align:left;"> Manuf Food Products And Beverages </td>
   <td style="text-align:right;"> 15 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Tobacco Products </td>
   <td style="text-align:right;"> 16 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Textiles </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Wear. Apparel; Dressing Dyeing Fur </td>
   <td style="text-align:right;"> 18 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Tanning Dress.Leather; luggage Footwear </td>
   <td style="text-align:right;"> 19 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Wood Products Except Furniture </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Pulp Paper And Paper Products </td>
   <td style="text-align:right;"> 21 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Coke Ref.Petroleum Nuclear Fuel </td>
   <td style="text-align:right;"> 23 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Chemicals And Chemical Products </td>
   <td style="text-align:right;"> 24 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Rubber And Plastic Products </td>
   <td style="text-align:right;"> 25 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Other Non-metallic Mineral Product </td>
   <td style="text-align:right;"> 26 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Basic Metals </td>
   <td style="text-align:right;"> 27 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Fabric.Metal Prod. Ex.Machin. Equi </td>
   <td style="text-align:right;"> 28 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Machinery And Equipment NEC </td>
   <td style="text-align:right;"> 29 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Office Machinery And Computers </td>
   <td style="text-align:right;"> 30 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Electrical Machinery Apparatus NE </td>
   <td style="text-align:right;"> 31 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Radio Television Communic.Equipmen </td>
   <td style="text-align:right;"> 32 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Medical Precision Optical Instrum. </td>
   <td style="text-align:right;"> 33 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Motor Vehicles Trailers Semi-tr. </td>
   <td style="text-align:right;"> 34 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Other Transport Equipment </td>
   <td style="text-align:right;"> 35 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manuf Furniture; Manufacturing NEC </td>
   <td style="text-align:right;"> 36 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Collection Purification Distrib.Of Water </td>
   <td style="text-align:right;"> 41 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Handcraft Trade - NEC </td>
   <td style="text-align:right;"> 97 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Manufacturing - NEC </td>
   <td style="text-align:right;"> 100 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="2"> Other </td>
   <td style="text-align:left;"> Private Households With Employed Persons </td>
   <td style="text-align:right;"> 95 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Extra-territorial Organizations.a.Bodies </td>
   <td style="text-align:right;"> 99 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="5"> Public Service </td>
   <td style="text-align:left;"> Publ.Administr. Defense; Compuls.SocSec </td>
   <td style="text-align:right;"> 75 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Education </td>
   <td style="text-align:right;"> 80 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Health And Social Work </td>
   <td style="text-align:right;"> 85 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Activit.of.Membership Organizations NEC. </td>
   <td style="text-align:right;"> 91 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Other Service Activities </td>
   <td style="text-align:right;"> 93 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="11"> Sales and Service </td>
   <td style="text-align:left;"> Publishing Printing Recorded Media </td>
   <td style="text-align:right;"> 22 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Construction </td>
   <td style="text-align:right;"> 45 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Sale Maint Rep.Mot.Vehicles;Ret.Sale Fue </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Wholesale Commission Trade Exc.Mot.Vehic </td>
   <td style="text-align:right;"> 51 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Retail Trade Exc.Mot.Vehic;Mot.Cyc Repai </td>
   <td style="text-align:right;"> 52 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Hotels And Restaurants </td>
   <td style="text-align:right;"> 55 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Post And Telecommunications </td>
   <td style="text-align:right;"> 64 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Real Estate Property Activities </td>
   <td style="text-align:right;"> 70 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Rent.Machinery Equip Wo.Oper. P. HH Good </td>
   <td style="text-align:right;"> 71 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Recreational Cultural Sporting Activity </td>
   <td style="text-align:right;"> 92 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Services - NEC </td>
   <td style="text-align:right;"> 98 </td>
  </tr>
  <tr>
   <td style="text-align:left;vertical-align: top !important;" rowspan="4"> Transportation </td>
   <td style="text-align:left;"> Land Transport; Transport Via Pipelines </td>
   <td style="text-align:right;"> 60 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Water Transport </td>
   <td style="text-align:right;"> 61 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Air Transport </td>
   <td style="text-align:right;"> 62 </td>
  </tr>
  <tr>
   
   <td style="text-align:left;"> Supporting Aux.Transp.Activ;Trav.Agencie </td>
   <td style="text-align:right;"> 63 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
</div>
</div>
</section>
<section id="mosaic-plots" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="mosaic-plots"><span style="color:white;">Mosaic Plots</span></h2>
<ul>
<li>Unlike bar charts, mosaic plots allow us to index relative areas, sizes, proportions, etc. relative to two dimensions (so not just amount)</li>
<li>So in our example, this will let us see relative differences within categories vertically and across categories horizontally</li>
<li>To build this, we will finally leave the basic <code>ggplot2</code> package and use the <code>ggmosaic</code> package</li>
<li>There are other packages, but we’ll use this one because (1) it’s great and (2) it let’s us still use everything we’ve learned about ggplot</li>
</ul>
</section>
<section id="mosaic-plots-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="mosaic-plots-1"><span style="color:white;">Mosaic Plots</span></h2>
<section id="wrangle-the-data" class="level3">
<h3 class="anchored" data-anchor-id="wrangle-the-data">Wrangle the Data</h3>
<p>(Review this on your own time!)</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">"ggmosaic"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">"ggmosaic"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a>gsoep_jobs <span class="ot">&lt;-</span> gsoep <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="fu">mutate</span>(<span class="at">age_gr =</span> <span class="fu">mapvalues</span>(age, <span class="dv">20</span><span class="sc">:</span><span class="dv">99</span>, <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">90</span>, <span class="dv">10</span>), <span class="at">each =</span> <span class="dv">10</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age_gr) <span class="sc">&amp;</span> age <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(job)) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>  <span class="fu">filter</span>(age_gr <span class="sc">==</span> <span class="fu">max</span>(age_gr)) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="fu">group_by</span>(SID, age_gr) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>  <span class="fu">summarize</span>(<span class="at">job =</span> <span class="fu">max</span>(job)) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="fu">rename</span>(<span class="at">code =</span> job) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="fu">left_join</span>(jobs <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">code =</span> old)) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="fu">group_by</span>(code) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(.) <span class="sc">&gt;=</span> .<span class="dv">02</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb27-18"><a href="#cb27-18"></a>gsoep_jobs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,326 × 5
      SID age_gr  code job                                      cat             
    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                                    &lt;chr&gt;           
 1  12303     40    85 Health And Social Work                   Public Service  
 2  13603     60    80 Education                                Public Service  
 3  35905     60    85 Health And Social Work                   Public Service  
 4  71704     30    28 Manuf Fabric.Metal Prod. Ex.Machin. Equi Manufacturing   
 5  73605     80    29 Manuf Machinery And Equipment NEC        Manufacturing   
 6  79603     20    55 Hotels And Restaurants                   Sales and Servi…
 7  84805     70    45 Construction                             Sales and Servi…
 8  85307     30    74 Other Business Activities                Finance and Tech
 9  89405     70    74 Other Business Activities                Finance and Tech
10 112505     30    65 Financ.Intermediat. Exc.Insur. Pens.Fund Finance and Tech
# ℹ 4,316 more rows</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="mosaic-plots-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="mosaic-plots-2"><span style="color:white;">Mosaic Plots</span></h2>
<ul>
<li>Let’s say, for example, that we think that functional limitations and more may age people out of some professions</li>
<li>We could look at this simply as a stacked bar chart, but it wouldn’t clarify that there are different proportions of people in each job category / age group</li>
<li>We’ve already had a bunch of practice today improving plot aesthetics and seen somewhat similar plots, so we’re going to skip that for this exercise</li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>gsoep_jobs <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>    <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(age_gr), <span class="at">fill =</span> cat)) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="treemap" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap"><span style="color:white;">Treemap</span></h2>
<ul>
<li>Mosaic plots are sort of just fancy stacked bar plots that let you also index by size</li>
<li>Treemaps are helpful when we have nested categorical (and sometimes, to a lesser degree continuous) variables</li>
<li>We’ll use the example of our jobs data, but this could be used for lots of other types of variables
<ul>
<li>Crossed conditions in an experiment</li>
<li>Intergenerational data</li>
<li>Average scores on variables within categories</li>
<li>Brain activation across broader and narrower brain regions</li>
<li>Political affiliation across states, demographic groups, and more</li>
</ul></li>
</ul>
</section>
<section id="treemap-1" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-1"><span style="color:white;">Treemap</span></h2>
<section id="wrangle-the-data-1" class="level3">
<h3 class="anchored" data-anchor-id="wrangle-the-data-1">Wrangle the Data</h3>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>gsoep_tm <span class="ot">&lt;-</span> gsoep <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(job)) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">job =</span> <span class="fu">max</span>(job)) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">code =</span> job) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(jobs <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">code =</span> old)) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code, cat, job) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">/</span><span class="fu">sum</span>(n) <span class="sc">&gt;</span> .<span class="dv">02</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">job =</span> <span class="fu">str_wrap</span>(job, <span class="dv">15</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>gsoep_tm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
    code cat               job                                               n
   &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;                                         &lt;int&gt;
 1     1 Agriculture       "Agriculture\nHunting\nRel.Serv.Activities"     272
 2    15 Manufacturing     "Manuf Food\nProducts And\nBeverages"           172
 3    17 Manufacturing     "Manuf Textiles"                                122
 4    28 Manufacturing     "Manuf\nFabric.Metal\nProd.\nEx.Machin. Equi"   188
 5    29 Manufacturing     "Manuf Machinery\nAnd Equipment\nNEC"           144
 6    31 Manufacturing     "Manuf\nElectrical\nMachinery\nApparatus NE"    123
 7    45 Sales and Service "Construction"                                  370
 8    52 Sales and Service "Retail Trade\nExc.Mot.Vehic;Mot.Cyc\nRepai"    718
 9    55 Sales and Service "Hotels And\nRestaurants"                       305
10    60 Transportation    "Land Transport;\nTransport Via\nPipelines"     162
11    65 Finance and Tech  "Financ.Intermediat.\nExc.Insur.\nPens.Fund"    123
12    74 Finance and Tech  "Other Business\nActivities"                    286
13    75 Public Service    "Publ.Administr.\nDefense;\nCompuls.SocSec"     421
14    80 Public Service    "Education"                                     339
15    85 Public Service    "Health And\nSocial Work"                       587</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-2" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-2"><span style="color:white;">Treemap</span></h2>
<section id="basic" class="level3">
<h3 class="anchored" data-anchor-id="basic">Basic</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">"treemapify"</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) <span class="fu">install.packages</span>(<span class="st">"treemapify"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">library</span>(treemapify)</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-3" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-3"><span style="color:white;">Treemap</span></h2>
<section id="improvements-remove-legend-and-add-labels" class="level3">
<h3 class="anchored" data-anchor-id="improvements-remove-legend-and-add-labels">Improvements: Remove Legend and Add Labels</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">geom_treemap_text</span>(</span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>    , <span class="at">place =</span> <span class="st">"centre"</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>    , <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>    , <span class="at">grow =</span> <span class="cn">FALSE</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>    ) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-4" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-4"><span style="color:white;">Treemap</span></h2>
<section id="improvements-add-subgroup-text" class="level3">
<h3 class="anchored" data-anchor-id="improvements-add-subgroup-text">Improvements: Add Subgroup Text</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">geom_treemap_text</span>(</span>
<span id="cb34-6"><a href="#cb34-6"></a>    <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>))</span>
<span id="cb34-7"><a href="#cb34-7"></a>    , <span class="at">place =</span> <span class="st">"centre"</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>    , <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>    , <span class="at">grow =</span> <span class="cn">FALSE</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>    ) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>  <span class="fu">geom_treemap_subgroup_text</span>(</span>
<span id="cb34-12"><a href="#cb34-12"></a>    <span class="at">place =</span> <span class="st">"bottom"</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>    , <span class="at">grow =</span> <span class="cn">TRUE</span></span>
<span id="cb34-14"><a href="#cb34-14"></a>    , <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb34-15"><a href="#cb34-15"></a>    , <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb34-16"><a href="#cb34-16"></a>    , <span class="at">fontface =</span> <span class="st">"italic"</span></span>
<span id="cb34-17"><a href="#cb34-17"></a>    ) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-5" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-5"><span style="color:white;">Treemap</span></h2>
<section id="improvements-color-palette" class="level3">
<h3 class="anchored" data-anchor-id="improvements-color-palette">Improvements: Color Palette</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">geom_treemap_text</span>(</span>
<span id="cb35-6"><a href="#cb35-6"></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>    , <span class="at">place =</span> <span class="st">"centre"</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>    , <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>    , <span class="at">grow =</span> <span class="cn">FALSE</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>    ) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>  <span class="fu">geom_treemap_subgroup_text</span>(</span>
<span id="cb35-12"><a href="#cb35-12"></a>    <span class="at">place =</span> <span class="st">"bottom"</span></span>
<span id="cb35-13"><a href="#cb35-13"></a>    , <span class="at">grow =</span> <span class="cn">TRUE</span></span>
<span id="cb35-14"><a href="#cb35-14"></a>    , <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb35-15"><a href="#cb35-15"></a>    , <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>    , <span class="at">fontface =</span> <span class="st">"italic"</span></span>
<span id="cb35-17"><a href="#cb35-17"></a>    ) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18"></a>  <span class="fu">scale_fill_viridis_d</span>()  <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-6" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-6"><span style="color:white;">Treemap</span></h2>
<section id="improvements-group-and-subgroup-borders-text-color" class="level3">
<h3 class="anchored" data-anchor-id="improvements-group-and-subgroup-borders-text-color">Improvements: Group and Subgroup Borders + Text Color</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">geom_treemap_text</span>(</span>
<span id="cb36-6"><a href="#cb36-6"></a>    <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>))</span>
<span id="cb36-7"><a href="#cb36-7"></a>    , <span class="at">place =</span> <span class="st">"centre"</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>    , <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>    , <span class="at">grow =</span> <span class="cn">FALSE</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>    ) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>  <span class="fu">geom_treemap_subgroup_text</span>(</span>
<span id="cb36-12"><a href="#cb36-12"></a>    <span class="at">place =</span> <span class="st">"bottom"</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>    , <span class="at">grow =</span> <span class="cn">TRUE</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>    , <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>    , <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>))</span>
<span id="cb36-16"><a href="#cb36-16"></a>    , <span class="at">fontface =</span> <span class="st">"italic"</span></span>
<span id="cb36-17"><a href="#cb36-17"></a>    ) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>  <span class="fu">geom_treemap_subgroup_border</span>(</span>
<span id="cb36-19"><a href="#cb36-19"></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>    , <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb36-21"><a href="#cb36-21"></a>    ) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22"></a>  <span class="fu">scale_fill_viridis_d</span>()  <span class="sc">+</span></span>
<span id="cb36-23"><a href="#cb36-23"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="treemap-7" class="level2 smaller" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%">
<h2 class="smaller anchored" data-background-color="white" data-background-image="https://github.com/emoriebeck/psc290-dataviz-WQ25/raw/main/psc290-dataviz-WQ25/03-images/red-top.png" data-background-size="100%" data-anchor-id="treemap-7"><span style="color:white;">Treemap</span></h2>
<section id="improvements-title" class="level3">
<h3 class="anchored" data-anchor-id="improvements-title">Improvements: Title</h3>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,4]">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>gsoep_tm <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">arrange</span>(cat, code) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> cat, <span class="at">label =</span> job, <span class="at">subgroup =</span> cat)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">geom_treemap</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">geom_treemap_text</span>(</span>
<span id="cb37-6"><a href="#cb37-6"></a>    <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>))</span>
<span id="cb37-7"><a href="#cb37-7"></a>    , <span class="at">place =</span> <span class="st">"centre"</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>    , <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>    , <span class="at">grow =</span> <span class="cn">FALSE</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>    ) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fu">geom_treemap_subgroup_text</span>(</span>
<span id="cb37-12"><a href="#cb37-12"></a>    <span class="at">place =</span> <span class="st">"bottom"</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>    , <span class="at">grow =</span> <span class="cn">TRUE</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>    , <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb37-15"><a href="#cb37-15"></a>    , <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>))</span>
<span id="cb37-16"><a href="#cb37-16"></a>    , <span class="at">fontface =</span> <span class="st">"italic"</span></span>
<span id="cb37-17"><a href="#cb37-17"></a>    ) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18"></a>  <span class="fu">geom_treemap_subgroup_border</span>(</span>
<span id="cb37-19"><a href="#cb37-19"></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb37-20"><a href="#cb37-20"></a>    , <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>    ) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22"></a>  <span class="fu">scale_fill_viridis_d</span>()  <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"White Collar Public Service, Sales, and</span><span class="sc">\n</span><span class="st">Finance Jobs Far Outnumber Blue Collar Jobs"</span>) <span class="sc">+</span> </span>
<span id="cb37-24"><a href="#cb37-24"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-25"><a href="#cb37-25"></a>        , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-fig.dim="[6,6]">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-week3-slides-code_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="activity-lab-time" class="level1">
<h1>Activity / Lab Time</h1>
<section id="activity-lab-time-if-time" class="level2">
<h2 class="anchored" data-anchor-id="activity-lab-time-if-time">Activity / Lab Time (If time)</h2>
<ul>
<li>For the rest of class, I want you to take some of your own data or the data provided in the workbook version of these slides to create some visualization of proportions.</li>
<li>Don’t overthink this, this is just your chance to apply what you’ve learned as we move into the “content area” portion of the course. * This is not a graded exercise but a chance to try to use your skills while also having the opportunity to ask questions of the instructors or your peers</li>
<li>You can work individually or in small groups, but I suggest at least trying to create the visualization independently, even if you work in small groups to come up with the idea and debug</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>