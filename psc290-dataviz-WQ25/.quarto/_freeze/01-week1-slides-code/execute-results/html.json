{
  "hash": "c848a72764d3a9682dc9d2c565d9ecc7",
  "result": {
    "markdown": "---\ntitle: \"Week 1 - Getting Situated in R and tidyverse \"\nauthor: \"Emorie D Beck\"\nformat: \n  revealjs:\n    incremental: true\n    code-tools: true\n    code-copy: true\n    code-line-numbers: true\n    code-link: true\n    preview-links: true\n    slide-number: true\n    self-contained: true\n    css: custom.css\n    theme: psc290\n    highlight-style: atom-one-dark\n    margin-left: \"0\"\n    margin-right: \"0\"\n    # width: 1400\n    # height: 900\n    footer: \"PSC 290 - Data Visualization\"\n    logo: \"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/ucdavis_logo_blue.png\"\n  # pptx: \n  #   incremental: true  \n  #   # code-tools: true\n  #   # code-copy: true\n  #   # code-line-numbers: true\n  #   # code-link: true\n  #   css: custom.css\n  #   theme: psc290\n  #   highlight-style: atom-one-dark\n  #   footer: \"PSC 290 - Data Visualization\"\n  #   logo: \"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/ucdavis_logo_blue.png\"\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(knitr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'knitr' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(psych)\nlibrary(plyr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ ggplot2::%+%()     masks psych::%+%()\n✖ ggplot2::alpha()   masks psych::alpha()\n✖ dplyr::arrange()   masks plyr::arrange()\n✖ purrr::compact()   masks plyr::compact()\n✖ dplyr::count()     masks plyr::count()\n✖ dplyr::desc()      masks plyr::desc()\n✖ dplyr::failwith()  masks plyr::failwith()\n✖ dplyr::filter()    masks stats::filter()\n✖ dplyr::id()        masks plyr::id()\n✖ dplyr::lag()       masks stats::lag()\n✖ dplyr::mutate()    masks plyr::mutate()\n✖ dplyr::rename()    masks plyr::rename()\n✖ dplyr::summarise() masks plyr::summarise()\n✖ dplyr::summarize() masks plyr::summarize()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n## Course Goals & Learning Outcomes\n\n1.  Understand the cognitive and psychological underpinnings of perceiving data visualization.\n2.  Identify good data visualizations and describe what makes them good.\n3.  Produce data visualizations according to types of questions, data, and more, with a particular emphasis on building a toolbox that you can carry into your own research.\n\n## Course Expectations\n\n-   \\~50% of the course will be in R\n-   You will get the most from this course if you:\n    -   have your own data you can apply course content to\n    -   know how to clean clean, transform, and manage that data\n    -   today's workshop is a good litmus test for this\n\n## Course Materials\n\n-   All materials (required and optional) are free and online\n    -   Wickham & Grolemond: *R for Data Science* <https://r4ds.had.co.nz>\n    -   Wickham: *Advanced R* <http://adv-r.had.co.nz>\n    -   Wilke: *Fundamentals of Data Visualization* <https://clauswilke.com/dataviz/>\n    -   Healy: *Data Visualization: A Practical Introduction* <https://socviz.co>\n    -   [Data Camp](https://www.datacamp.com/groups/shared_links/bd4b5bf66c2195741f388ca82c1b19c89b6f37754c7cfa0eb5aded5f16678360): All paid content unlocked\n\n## Assignments\n\n| Assignment Weights               | Percent  |\n|----------------------------------|----------|\n| Class Participation              | 20%      |\n| Response Papers + Visualizations | 20%      |\n| Final Project Proposal           | 10%      |\n| Class Presentation               | 20%      |\n| Final Project                    | 30%      |\n| **Total**                        | **100%** |\n\n## Assignments\n\n### Class Participation\n\n-   There are lots of ways to participate, both in and outside class meetings\n-   Classes will be technologically hybrid\n-   The goal of this is for accessibility and to create recordings\n-   If you need to miss 2 classes (i.e. 20% of total class time), maybe consider taking the course in a different year\n-   If you must miss class, please let me know ahead of time if possible\n\n## Assignments\n\n### Response Papers / Visualizations\n\n-   The main homework in the course is your weekly visualization assignment\n-   The goal is to demonstrate how the principles and skills you learn in the class function \"in the wild.\"\n-   These should be fun and not taken too seriously! No one is judging you for a pulling a graphic from Instagram instead of Nature.\n-   Due 12:01 AM each Monday (last class is \"free points\")\n\n## Assigments\n\n### Final Projects\n\n-   I don't want you to walk out of this course and not know how to apply what you learned\n-   Final project replaces final exam (there are no exams)\n-   Create a visualization for an ongoing project!\n    -   Stage 1: Proposal (due 10/31/22)\n    -   Stage 2: 1-on-1 meetings + feedback\n    -   Stage 3: In-class presentations (11/28)\n    -   Stage 4: Final visualization + brief write-up (??)\n\n## Assignments\n\n### Extra Credit\n\n-   Lots of job searches this fall\n-   1 pt extra credit for each one you:\n    -   go to,\n    -   take a snap of a data viz,\n    -   and critique it according to what you've learned in class\n-   max 5 pts\n\n## Class Time\n\n-   \\~5-10 min: welcome and review (if needed)\n-   \\~10-20 min: data viz of the week\n-   \\~30-45 min: discussion of readings\n-   \\~5-10 min: break\n-   \\~60-90 min: workshop\n-   \\~20-30 min: open lab\n\n## Course Topics\n\n::: columns\n::: column\n1.  Intro and Overview\n2.  Cognitive Perspectives\n3.  Proportions and Probability\n4.  Differences and Associations\n5.  Change and Time Series\n6.  Uncertainty\n7.  Piecing Visualizations Together\n:::\n\n::: column\n8.  Polishing Visualizations\n9.  Interactive Visualizations Additional Topics:\n\n-   Spatial Information\n-   Automated Reports\n-   Diagrams\n-   More?\n:::\n:::\n\n# Questions on the Syllabus and Course?\n\n# Data Viz of the Week and Discussion\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/leo-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/leo-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/acre-map-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/acre-map-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/vote-map-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/vote-map-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/mmr-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/mmr-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/batman-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/batman-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/BadVizWk1.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/BadVizWk1.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/chaos-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/chaos-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/diff-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/diff-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/monkeypox-viz.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/monkeypox-viz.png){fig-align='center'}\n:::\n:::\n\n\n## Good or Bad?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/water-use-viz.jpg\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/water-use-viz.jpg){fig-align='center'}\n:::\n:::\n\n\n# Data Visualization\n\n## Why Should I Care About Data Visualization\n\n-   Summarizing huge amounts of information\n-   Seeing the forest and the trees\n-   Errors in probabilistic reasoning\n-   It's fun!\n\n## Why Visualize Data in R\n\n::: columns\n::: {.column width=\"60%\"}\n-   Open source and freeeee\n-   Flexible\n-   Reproducible\n-   Flexible formatting / output\n-   Lots of model- and package-specific support\n-   Did I mention free?\n:::\n\n::: {.column width=\"40%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/R_logo.svg.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/R_logo.svg.png)\n:::\n:::\n\n:::\n:::\n\n## Why Use RStudio (Pivot)\n\n::: columns\n::: {.column width=\"60%\"}\n-   Also free\n-   Basically a GUI for R\n-   Organize files, import data, etc. with ease\n-   RMarkdown, Quarto, and more are powerful tools (they were used to create these slides!)\n-   Lots of new features and support\n:::\n\n::: {.column width=\"40%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/RStudio-Logo-Flat.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/RStudio-Logo-Flat.png)\n:::\n:::\n\n:::\n:::\n\n## Why Use the `tidyverse`\n\n::: columns\n::: {.column width=\"70%\"}\n-   Maintained by RStudio (Pivot)\n-   No one should have to use a for loop to change data from long to wide\n-   Tons of integrated tools for data cleaning, manipulation, transformation, and visualization\n-   Even increasing support for modeling (e.g., `tidymodels`)\n:::\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/tidyverse.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/emoriebeck/psc290-data-viz-2022/raw/main/01-week1-intro/02-code/02-images/tidyverse.png){fig-align='center'}\n:::\n:::\n\n:::\n:::\n\n## Why Use the `tidyverse`\n\n::: {layout=\"[[1,1, 1, 1, 1, 1], [1,1, 1, 1, 1,1]]\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/tidyr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/tidyr.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/stringr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/stringr.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/shiny.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/shiny.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/rmarkdown.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/rmarkdown.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/quarto.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/quarto.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/knitr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/knitr.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/ggplot2.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/ggplot2.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/forcats.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/forcats.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/dplyr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/dplyr.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/broom.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/broom.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/tibble.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/tibble.png){fig-align='center'}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/purrr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/purrr.png){fig-align='center'}\n:::\n:::\n\n:::\n\n## Goals for Today\n\n-   **Review** core principles of:\n    -   `dyplr` (data manipulation)\n    -   `tidyr` (data transformation and reshaping)\n\n------------------------------------------------------------------------\n\n::: {.columns .v-center-container}\n::: {.column width=\"70%\"}\n<p style=\"font-size:160%;\">\n\nData Manipulation in `dplyr`\n\n</p>\n:::\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/dplyr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/dplyr.png){fig-align='center'}\n:::\n:::\n\n:::\n:::\n\n## Core Functions\n\n1.  **`%>%`**: The pipe. Read as \"and then.\"\n2.  **`filter()`**: Pick observations (rows) by their values.\n3.  **`select()`**: Pick variables (columns) by their names.\n4.  **`arrange()`**: Reorder the rows.\n5.  **`group_by()`**: Implicitly split the data set by grouping by names (columns).\n6.  **`mutate()`**: Create new variables with functions of existing variables.\n7.  **`summarize()` / `summarise()`**: Collapse many values down to a single summary.\n\n## Core Functions\n\n::: columns\n::: {.column width=\"40%\"}\n::: nonincremental\n1.  **`%>%`**\n2.  **`filter()`**\n3.  **`select()`**\n4.  **`arrange()`**\n5.  **`group_by()`**\n6.  **`mutate()`**\n7.  **`summarize()`**\n:::\n:::\n\n::: {.column width=\"60%\" style=\"text-align: center; background-color: #FFD966; color: black; border: 5px solid #033266;\"}\nAlthough each of these functions are powerful alone, they are incredibly powerful in conjunction with one another. So below, I'll briefly introduce each function, then link them all together using an example of basic data cleaning and summary.\n:::\n:::\n\n## 1. `%>%`\n\n-   The pipe `%>%` is wonderful. It makes coding intuitive. Often in coding, you need to use so-called nested functions. For example, you might want to round a number after taking the square of 43.\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(43)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.557439\n```\n:::\n\n```{.r .cell-code}\nround(sqrt(43), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.56\n```\n:::\n:::\n\n:::\n\n## 1. `%>%`\n\nThe issue with this comes whenever we need to do a series of operations on a data set or other type of object. In such cases, if we run it in a single call, then we have to start in the middle and read our way out.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(sqrt(43/2), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.64\n```\n:::\n:::\n\n\n## 1. `%>%`\n\nThe pipe solves this by allowing you to read from left to right (or top to bottom). The easiest way to think of it is that each call of `%>%` reads and operates as \"and then.\" So with the rounded square root of 43, for example:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(43) %>%\n  round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.56\n```\n:::\n:::\n\n:::\n\n## 2. `filter()`\n\n::: fragment\nOften times, when conducting research (experiments or otherwise), there are observations (people, specific trials, etc.) that you don't want to include.\n:::\n\n<!-- Say for example, that you're interested personality change in adolescence, but you just opened a survey up online. So when you actually download and examine your data, you realize that you have an age range of something like 3-86, not 12-18. In this case, you want to get rid of the people over 18 -- that is, `filter()` them out.   -->\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(bfi) # grab the bfi data from the psych package\nbfi <- bfi %>% as_tibble()\nhead(bfi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 28\n     A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2    E3\n  <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1     2     4     3     4     4     2     3     3     4     4     3     3     3\n2     2     4     5     2     5     5     4     4     3     4     1     1     6\n3     5     4     5     4     4     4     5     4     2     5     2     4     4\n4     4     4     6     5     5     4     4     3     5     5     5     3     4\n5     2     3     3     4     5     4     4     5     3     2     2     2     5\n6     6     6     5     6     5     6     6     6     1     3     2     1     6\n# ℹ 15 more variables: E4 <int>, E5 <int>, N1 <int>, N2 <int>, N3 <int>,\n#   N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>, O5 <int>,\n#   gender <int>, education <int>, age <int>\n```\n:::\n:::\n\n:::\n\n## 2. `filter()`\n\nOften times, when conducting research (experiments or otherwise), there are observations (people, specific trials, etc.) that you don't want to include.\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(bfi$age) # get age descriptives\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   3.00   20.00   26.00   28.78   35.00   86.00 \n```\n:::\n:::\n\n:::\n\n## 2. `filter()`\n\nOften times, when conducting research (experiments or otherwise), there are observations (people, specific trials, etc.) that you don't want to include.\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2\"}\nbfi2 <- bfi %>% # see a pipe!\n  filter(age <= 18) # filter to age up to 18\n\nsummary(bfi2$age) # summary of the new data \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    3.0    16.0    17.0    16.3    18.0    18.0 \n```\n:::\n:::\n\n:::\n\n::: fragment\nBut this isn't quite right. We still have folks below 12. But, the beauty of `filter()` is that you can do sequence of `OR` and `AND` statements when there is more than one condition, such as up to 18 `AND` at least 12.\n:::\n\n## 2. `filter()`\n\nOften times, when conducting research (experiments or otherwise), there are observations (people, specific trials, etc.) that you don't want to include.\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi2 <- bfi %>%\n  filter(age <= 18 & age >= 12) # filter to age up to 18 and at least 12\n\nsummary(bfi2$age) # summary of the new data \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   12.0    16.0    17.0    16.4    18.0    18.0 \n```\n:::\n:::\n\n:::\n\n::: fragment\nGot it!\n:::\n\n## 2. `filter()`\n\n-   But filter works for more use cases than just conditional\n    -   `<`, `>`, `<=`, and `>=`\n-   It can also be used for cases where we want a single values to match cases with text.\n-   To do that, let's convert one of the variables in the `bfi` data frame to a string.\n-   So let's change gender (1 = male, 2 = female) to text (we'll get into factors later).\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi$education <- plyr::mapvalues(bfi$education, 1:5, c(\"Below HS\", \"HS\", \"Some College\", \"College\", \"Higher Degree\"))\n```\n:::\n\n:::\n\n## 2. `filter()`\n\nNow let's try a few things:\n\n<font color = \"#033266\">**1. Create a data set with only individuals with some college (`==`).**</font>\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi2 <- bfi %>% \n  filter(education == \"Some College\")\nunique(bfi2$education)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Some College\"\n```\n:::\n:::\n\n:::\n\n## 2. `filter()`\n\nNow let's try a few things:\n\n<font color = \"#033266\">**2. Create a data set with only people age 18 (`==`).**</font>\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi2 <- bfi %>%\n  filter(age == 18)\nsummary(bfi2$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n     18      18      18      18      18      18 \n```\n:::\n:::\n\n:::\n\n## 2. `filter()`\n\nNow let's try a few things:\n\n<font color = \"#033266\">**3. Create a data set with individuals with some college or above (`%in%`).**</font>\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi2 <- bfi %>%\n  filter(education %in% c(\"Some College\", \"College\", \"Higher Degree\"))\nunique(bfi2$education)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Some College\"  \"Higher Degree\" \"College\"      \n```\n:::\n:::\n\n:::\n\n::: fragment\n`%in%` is great. It compares a column to a vector rather than just a single value, you can compare it to several\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi2 <- bfi %>%\n  filter(age %in% 12:18)\nsummary(bfi2$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   12.0    16.0    17.0    16.4    18.0    18.0 \n```\n:::\n:::\n\n:::\n\n## 3. `select()`\n\n-   If `filter()` is for pulling certain observations (rows), then `select()` is for pulling certain variables (columns).\n-   it's good practice to remove these columns to stop your environment from becoming cluttered and eating up your RAM.\n\n## 3. `select()`\n\n-   In our `bfi` data, most of these have been pre-removed, so instead, we'll imagine we don't want to use any indicators of Agreeableness (A1-A5) and that we aren't interested in gender.\n-   With `select()`, there are few ways choose variables. We can bare quote name the ones we want to keep, bare quote names we want to remove, or use any of a number of `select()` helper functions.\n\n## 3. `select()`:\n\n### A. Bare quote columns we want to keep:\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2\"}\nbfi %>%\n  select(C1, C2, C3, C4, C5) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 5\n     C1    C2    C3    C4    C5\n  <int> <int> <int> <int> <int>\n1     2     3     3     4     4\n2     5     4     4     3     4\n3     4     5     4     2     5\n4     4     4     3     5     5\n5     4     4     5     3     2\n6     6     6     6     1     3\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2\"}\nbfi %>%\n  select(C1:C5) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 5\n     C1    C2    C3    C4    C5\n  <int> <int> <int> <int> <int>\n1     2     3     3     4     4\n2     5     4     4     3     4\n3     4     5     4     2     5\n4     4     4     3     5     5\n5     4     4     5     3     2\n6     6     6     6     1     3\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n\n<!-- We can also use `:` to grab a *range* of columns.   -->\n:::\n:::\n:::\n\n## 3. `select()`:\n\n### B. Bare quote columns we don't want to keep:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2\"}\nbfi %>% \n  select(-(A1:A5), -gender) %>% # Note the `()` around the columns\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 22\n     C1    C2    C3    C4    C5    E1    E2    E3    E4    E5    N1    N2    N3\n  <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1     2     3     3     4     4     3     3     3     4     4     3     4     2\n2     5     4     4     3     4     1     1     6     4     3     3     3     3\n3     4     5     4     2     5     2     4     4     4     5     4     5     4\n4     4     4     3     5     5     5     3     4     4     4     2     5     2\n5     4     4     5     3     2     2     2     5     4     5     2     3     4\n6     6     6     6     1     3     2     1     6     5     6     3     5     2\n# ℹ 2,794 more rows\n# ℹ 9 more variables: N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>,\n#   O4 <int>, O5 <int>, education <chr>, age <int>\n```\n:::\n:::\n\n:::\n\n## 3. `select()`:\n\n### C. Add or remove using `select()` helper functions.\n\n::: columns\n::: {.column width=\"40%\"}\n-   `starts_with()`\\\n-   `ends_with()`\n-   `contains()`\n-   `matches()`\n-   `num_range()`\n-   `one_of()`\n-   `all_of()`\n:::\n\n::: {.column width=\"60%\"}\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 5\n      C1    C2    C3    C4    C5\n   <int> <int> <int> <int> <int>\n 1     2     3     3     4     4\n 2     5     4     4     3     4\n 3     4     5     4     2     5\n 4     4     4     3     5     5\n 5     4     4     5     3     2\n 6     6     6     6     1     3\n 7     5     4     4     2     3\n 8     3     2     4     2     4\n 9     6     6     3     4     5\n10     6     5     6     2     1\n# ℹ 2,790 more rows\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 4. `arrange()`\n\n-   Sometimes, either in order to get a better sense of our data or in order to well, order our data, we want to sort it\n-   Although there is a base `R` `sort()` function, the `arrange()` function is `tidyverse` version that plays nicely with other `tidyverse functions`.\n\n## 4. `arrange()`\n\n::: columns\nSo in our previous examples, we could also `arrange()` our data by age or education, rather than simply filtering. (Or as we'll see later, we can do both!)\n\n::: {.column width=\"50%\"}\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|4\"}\n# sort by age\nbfi %>% \n  select(gender:age) %>%\n  arrange(age) %>% \n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 3\n  gender education       age\n   <int> <chr>         <int>\n1      1 Higher Degree     3\n2      2 <NA>              9\n3      2 Some College     11\n4      2 <NA>             11\n5      2 <NA>             11\n6      2 <NA>             12\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n:::\n\n::: {.column width=\"50%\"}\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|4\"}\n# sort by education\nbfi %>%\n  select(gender:age) %>%\n  arrange(education) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 3\n  gender education   age\n   <int> <chr>     <int>\n1      1 Below HS     19\n2      1 Below HS     21\n3      1 Below HS     17\n4      1 Below HS     18\n5      1 Below HS     18\n6      2 Below HS     18\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 4. `arrange()`\n\nWe can also arrange by multiple columns, like if we wanted to sort by gender then education:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(gender:age) %>%\n  arrange(gender, education) %>% \n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 3\n  gender education   age\n   <int> <chr>     <int>\n1      1 Below HS     19\n2      1 Below HS     21\n3      1 Below HS     17\n4      1 Below HS     18\n5      1 Below HS     18\n6      1 Below HS     32\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n\n# Bringing it all together: Split-Apply-Combine\n\n## Bringing it all together: Split-Apply-Combine\n\n-   Much of the power of `dplyr` functions lay in the split-apply-combine method\n\n-   A given set of of data are:\n\n    -   *split* into smaller chunks\n    -   then a function or series of functions are *applied* to each chunk\n    -   and then the chunks are *combined* back together\n\n## 5. `group_by()`\n\n-   The `group_by()` function is the \"split\" of the method\n-   It basically implicitly breaks the data set into chunks by whatever bare quoted column(s)/variable(s) are supplied as arguments.\n\n## 5. `group_by()`\n\nSo imagine that we wanted to `group_by()` education levels to get average ages at each level\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  group_by(education) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 8\n# Groups:   education [6]\n     C1    C2    C3    C4    C5   age gender education   \n  <int> <int> <int> <int> <int> <int>  <int> <chr>       \n1     2     3     3     4     4    16      1 <NA>        \n2     5     4     4     3     4    18      2 <NA>        \n3     4     5     4     2     5    17      2 <NA>        \n4     4     4     3     5     5    17      2 <NA>        \n5     4     4     5     3     2    17      1 <NA>        \n6     6     6     6     1     3    21      2 Some College\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n\n## 5. `group_by()`\n\n-   Hadley's first law of data cleaning: \"What is split, must be combined\"\n-   This is super easy with the `ungroup()` function:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  group_by(education) %>%\n  ungroup() %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 8\n     C1    C2    C3    C4    C5   age gender education   \n  <int> <int> <int> <int> <int> <int>  <int> <chr>       \n1     2     3     3     4     4    16      1 <NA>        \n2     5     4     4     3     4    18      2 <NA>        \n3     4     5     4     2     5    17      2 <NA>        \n4     4     4     3     5     5    17      2 <NA>        \n5     4     4     5     3     2    17      1 <NA>        \n6     6     6     6     1     3    21      2 Some College\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n\n## 5. `group_by()`\n\nMultiple `group_by()` calls overwrites previous calls:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  group_by(education) %>%\n  group_by(gender, age) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 8\n# Groups:   gender, age [115]\n     C1    C2    C3    C4    C5   age gender education   \n  <int> <int> <int> <int> <int> <int>  <int> <chr>       \n1     2     3     3     4     4    16      1 <NA>        \n2     5     4     4     3     4    18      2 <NA>        \n3     4     5     4     2     5    17      2 <NA>        \n4     4     4     3     5     5    17      2 <NA>        \n5     4     4     5     3     2    17      1 <NA>        \n6     6     6     6     1     3    21      2 Some College\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n\n## 6. `mutate()`\n\n-   `mutate()` is one of your \"apply\" functions\n-   When you use `mutate()`, the resulting data frame will have the same number of rows you started with\n-   You are directly mutating the existing data frame, either modifying existing columns or creating new ones\n\n## 6. `mutate()`\n\nTo demonstrate, let's add a column that indicated average age levels within each age group\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  arrange(education) %>%\n  group_by(education) %>% \n  mutate(age_by_edu = mean(age, na.rm = T)) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 9\n# Groups:   education [6]\n     C1    C2    C3    C4    C5   age gender education age_by_edu\n  <int> <int> <int> <int> <int> <int>  <int> <chr>          <dbl>\n1     6     6     3     4     5    19      1 Below HS        25.1\n2     4     3     5     3     2    21      1 Below HS        25.1\n3     5     5     5     2     2    17      1 Below HS        25.1\n4     5     5     4     1     1    18      1 Below HS        25.1\n5     4     5     4     3     3    18      1 Below HS        25.1\n6     3     2     3     4     6    18      2 Below HS        25.1\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n\n## 6. `mutate()`\n\n`mutate()` is also super useful even when you aren't grouping\n\n::: fragment\nWe can create a new category\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  mutate(gender_cat = plyr::mapvalues(gender, c(1,2), c(\"Male\", \"Female\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 9\n      C1    C2    C3    C4    C5   age gender education    gender_cat\n   <int> <int> <int> <int> <int> <int>  <int> <chr>        <chr>     \n 1     2     3     3     4     4    16      1 <NA>         Male      \n 2     5     4     4     3     4    18      2 <NA>         Female    \n 3     4     5     4     2     5    17      2 <NA>         Female    \n 4     4     4     3     5     5    17      2 <NA>         Female    \n 5     4     4     5     3     2    17      1 <NA>         Male      \n 6     6     6     6     1     3    21      2 Some College Female    \n 7     5     4     4     2     3    18      1 <NA>         Male      \n 8     3     2     4     2     4    19      1 HS           Male      \n 9     6     6     3     4     5    19      1 Below HS     Male      \n10     6     5     6     2     1    17      2 <NA>         Female    \n# ℹ 2,790 more rows\n```\n:::\n:::\n\n:::\n\n## 6. `mutate()`\n\n`mutate()` is also super useful even when you aren't grouping\n\nWe could also just overwrite it:\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  mutate(gender = plyr::mapvalues(gender, c(1,2), c(\"Male\", \"Female\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 8\n      C1    C2    C3    C4    C5   age gender education   \n   <int> <int> <int> <int> <int> <int> <chr>  <chr>       \n 1     2     3     3     4     4    16 Male   <NA>        \n 2     5     4     4     3     4    18 Female <NA>        \n 3     4     5     4     2     5    17 Female <NA>        \n 4     4     4     3     5     5    17 Female <NA>        \n 5     4     4     5     3     2    17 Male   <NA>        \n 6     6     6     6     1     3    21 Female Some College\n 7     5     4     4     2     3    18 Male   <NA>        \n 8     3     2     4     2     4    19 Male   HS          \n 9     6     6     3     4     5    19 Male   Below HS    \n10     6     5     6     2     1    17 Female <NA>        \n# ℹ 2,790 more rows\n```\n:::\n:::\n\n:::\n\n## 7. `summarize()` / `summarise()`\n\n::: columns\n::: column\n-   `summarize()` is one of your \"apply\" functions\n-   The resulting data frame will have the same number of rows as your grouping variable\n-   You number of groups is 1 for ungrouped data frames\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\n# group_by() education\nbfi %>%\n  select(starts_with(\"C\"), age, gender, education) %>%\n  arrange(education) %>%\n  group_by(education) %>% \n  summarize(age_by_edu = mean(age, na.rm = T))  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  education     age_by_edu\n  <chr>              <dbl>\n1 Below HS            25.1\n2 College             33.0\n3 HS                  31.5\n4 Higher Degree       35.3\n5 Some College        27.2\n6 <NA>                18.0\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 7. `summarize()` / `summarise()`\n\n::: columns\n::: column\n::: nonincremental\n-   `summarize()` is one of your \"apply\" functions\n-   The resulting data frame will have the same number of rows as your grouping variable\n-   You number of groups is 1 for ungrouped data frames\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\n# no groups  \nbfi %>% \n  select(starts_with(\"C\"), age, gender, education) %>%\n  arrange(education) %>%\n  summarize(age_by_edu = mean(age, na.rm = T))  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  age_by_edu\n       <dbl>\n1       28.8\n```\n:::\n:::\n\n:::\n:::\n:::\n\n------------------------------------------------------------------------\n\n::: {.columns .v-center-container}\n::: {.column width=\"70%\"}\n<p style=\"font-size:160%;\">\n\nData Wrangling in `tidyr`\n\n</p>\n:::\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nknitr::include_graphics(\"https://github.com/rstudio/hex-stickers/raw/master/thumbs/tidyr.png\")\n```\n\n::: {.cell-output-display}\n![](https://github.com/rstudio/hex-stickers/raw/master/thumbs/tidyr.png){fig-align='center'}\n:::\n:::\n\n:::\n:::\n\n## `tidyr`\n\n-   Now, let's build off what we learned from dplyr and focus on *reshaping* and *merging* our data.\n-   First, the reshapers:\n\n1.  `pivot_longer()`, which takes a \"wide\" format data frame and makes it long.\\\n2.  `pivot_wider()`, which takes a \"long\" format data frame and makes it wide.\n\n## `tidyr`\n\n-   Next, the mergers:\n\n3.  `full_join()`, which merges *all* rows in either data frame\\\n4.  `inner_join()`, which merges rows whose keys are present in *both* data frames\\\n5.  `left_join()`, which \"prioritizes\" the first data set\\\n6.  `right_join()`, which \"prioritizes\" the second data set\n\n::: fragment\n(See also:`anti_join()` and `semi_join()`)\n:::\n\n# Key `tidyr` Functions\n\n## 1. `pivot_longer()` {.smaller}\n\n-   (Formerly `gather()`) Makes wide data long, based on a key <font size=\"5\">\n-   Core arguments:\n    -   `data`: the data, blank if piped\n    -   `cols`: columns to be made long, selected via `select()` calls\n    -   `names_to`: name(s) of key column(s) in new long data frame (string or string vector)\n    -   `values_to`: name of values in new long data frame (string)\n    -   `names_sep`: separator in column headers, if multiple keys\n    -   `values_drop_na`: drop missing cells (similar to `na.rm = T`) </font>\n\n## 1. `pivot_longer()`: Basic Application\n\nLet's start with an easy one -- one key, one value:\n\n::: columns\n::: column\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  pivot_longer(\n    cols = A1:O5\n    , names_to = \"item\"\n    , values_to = \"values\"\n    , values_drop_na = T\n  ) %>%\n  print(n = 8)\n```\n:::\n\n:::\n\n::: column\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 69,492 × 6\n  SID   gender education   age item  values\n  <chr>  <int> <chr>     <int> <chr>  <int>\n1 1          1 <NA>         16 A1         2\n2 1          1 <NA>         16 A2         4\n3 1          1 <NA>         16 A3         3\n4 1          1 <NA>         16 A4         4\n5 1          1 <NA>         16 A5         4\n6 1          1 <NA>         16 C1         2\n7 1          1 <NA>         16 C2         3\n8 1          1 <NA>         16 C3         3\n# ℹ 69,484 more rows\n```\n:::\n:::\n\n:::\n:::\n\n## 1. `pivot_longer()`: More Advanced Application\n\nNow a harder one -- two keys, one value:\n\n::: columns\n::: column\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  pivot_longer(\n    cols = A1:O5\n    , names_to = c(\"trait\", \"item_num\")\n    , names_sep = -1\n    , values_to = \"values\"\n    , values_drop_na = T\n  ) %>%\n  print(n = 8)\n```\n:::\n\n:::\n\n::: column\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 69,492 × 7\n  SID   gender education   age trait item_num values\n  <chr>  <int> <chr>     <int> <chr> <chr>     <int>\n1 1          1 <NA>         16 A     1             2\n2 1          1 <NA>         16 A     2             4\n3 1          1 <NA>         16 A     3             3\n4 1          1 <NA>         16 A     4             4\n5 1          1 <NA>         16 A     5             4\n6 1          1 <NA>         16 C     1             2\n7 1          1 <NA>         16 C     2             3\n8 1          1 <NA>         16 C     3             3\n# ℹ 69,484 more rows\n```\n:::\n:::\n\n:::\n:::\n\n## 2. `pivot_wider()` {.smaller}\n\n-   (Formerly `spread()`) Makes wide data long, based on a key <font size=\"6\">\n-   Core arguments:\n    -   `data`: the data, blank if piped\n    -   `names_from`: name(s) of key column(s) in new long data frame (string or string vector)\n    -   `names_sep`: separator in column headers, if multiple keys\n    -   `names_glue`: specify multiple or custom separators of multiple keys\n    -   `values_from`: name of values in new long data frame (string)\n    -   `values_fn`: function applied to data with duplicate labels </font>\n\n## 2. `pivot_wider()`: Basic Application\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi_long <- bfi %>%\n  rownames_to_column(\"SID\") %>%\n  pivot_longer(\n    cols = A1:O5\n    , names_to = \"item\"\n    , values_to = \"values\"\n    , values_drop_na = T\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2|3\"}\nbfi_long %>%\n  pivot_wider(\n    names_from = \"item\"\n    , values_from = \"values\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n   SID   gender education    age    A1    A2    A3    A4    A5    C1    C2    C3\n   <chr>  <int> <chr>      <int> <int> <int> <int> <int> <int> <int> <int> <int>\n 1 1          1 <NA>          16     2     4     3     4     4     2     3     3\n 2 2          2 <NA>          18     2     4     5     2     5     5     4     4\n 3 3          2 <NA>          17     5     4     5     4     4     4     5     4\n 4 4          2 <NA>          17     4     4     6     5     5     4     4     3\n 5 5          1 <NA>          17     2     3     3     4     5     4     4     5\n 6 6          2 Some Coll…    21     6     6     5     6     5     6     6     6\n 7 7          1 <NA>          18     2     5     5     3     5     5     4     4\n 8 8          1 HS            19     4     3     1     5     1     3     2     4\n 9 9          1 Below HS      19     4     3     6     3     3     6     6     3\n10 10         2 <NA>          17     2     5     6     6     5     6     5     6\n# ℹ 2,790 more rows\n# ℹ 17 more variables: C4 <int>, C5 <int>, E1 <int>, E2 <int>, E3 <int>,\n#   E4 <int>, E5 <int>, N1 <int>, N2 <int>, N3 <int>, N4 <int>, N5 <int>,\n#   O1 <int>, O2 <int>, O3 <int>, O4 <int>, O5 <int>\n```\n:::\n:::\n\n\n## 2. `pivot_wider()`: More Advanced\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi_long <- bfi %>%\n  rownames_to_column(\"SID\") %>%\n  pivot_longer(\n    cols = A1:O5\n    , names_to = c(\"trait\", \"item_num\")\n    , names_sep = -1\n    , values_to = \"values\"\n    , values_drop_na = T\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi_long %>%\n  pivot_wider(\n    names_from = c(\"trait\", \"item_num\")\n    , values_from = \"values\"\n    , names_sep = \"_\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n   SID   gender education    age   A_1   A_2   A_3   A_4   A_5   C_1   C_2   C_3\n   <chr>  <int> <chr>      <int> <int> <int> <int> <int> <int> <int> <int> <int>\n 1 1          1 <NA>          16     2     4     3     4     4     2     3     3\n 2 2          2 <NA>          18     2     4     5     2     5     5     4     4\n 3 3          2 <NA>          17     5     4     5     4     4     4     5     4\n 4 4          2 <NA>          17     4     4     6     5     5     4     4     3\n 5 5          1 <NA>          17     2     3     3     4     5     4     4     5\n 6 6          2 Some Coll…    21     6     6     5     6     5     6     6     6\n 7 7          1 <NA>          18     2     5     5     3     5     5     4     4\n 8 8          1 HS            19     4     3     1     5     1     3     2     4\n 9 9          1 Below HS      19     4     3     6     3     3     6     6     3\n10 10         2 <NA>          17     2     5     6     6     5     6     5     6\n# ℹ 2,790 more rows\n# ℹ 17 more variables: C_4 <int>, C_5 <int>, E_1 <int>, E_2 <int>, E_3 <int>,\n#   E_4 <int>, E_5 <int>, N_1 <int>, N_2 <int>, N_3 <int>, N_4 <int>,\n#   N_5 <int>, O_1 <int>, O_2 <int>, O_3 <int>, O_4 <int>, O_5 <int>\n```\n:::\n:::\n\n\n## 2. `pivot_wider()`: A Little More Advanced\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi_long %>%\n  select(-item_num) %>%\n  pivot_wider(\n    names_from = \"trait\"\n    , values_from = \"values\"\n    , names_sep = \"_\"\n    , values_fn = mean\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 9\n   SID   gender education      age     A     C     E     N     O\n   <chr>  <int> <chr>        <int> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1 1          1 <NA>            16   3.4   3.2  3.4    2.8   3.8\n 2 2          2 <NA>            18   3.6   4    3      3.8   3.2\n 3 3          2 <NA>            17   4.4   4    3.8    3.6   3.6\n 4 4          2 <NA>            17   4.8   4.2  4      2.8   3.6\n 5 5          1 <NA>            17   3.4   3.6  3.6    3.2   3.2\n 6 6          2 Some College    21   5.6   4.4  4      3     3.8\n 7 7          1 <NA>            18   4     3.6  4.2    1.4   3.8\n 8 8          1 HS              19   2.8   3    3.2    4.2   3.4\n 9 9          1 Below HS        19   3.8   4.8  3.75   3.6   5  \n10 10         2 <NA>            17   4.8   4    3.6    4.2   3.6\n# ℹ 2,790 more rows\n```\n:::\n:::\n\n\n# More `dplyr` Functions\n\n## The `_join()` Functions\n\n::: columns\n::: {.column width=\"60%\"}\n-   Often we may need to pull different data from different sources\n-   There are lots of reasons to need to do this\n-   We don't have time to get into all the use cases here, so we'll talk about them in high level terms\n:::\n\n::: {.column width=\"40%\"}\n-   We'll focus on:\n    -   `full_join()`\n    -   `inner_join()`\n    -   `left_join()`\n    -   `right_join()`\n:::\n:::\n\n## The `_join()` Functions\n\n-   Let's separate demographic and BFI data\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|3\"}\nbfi_only <- bfi %>% \n  rownames_to_column(\"SID\") %>%\n  select(SID, matches(\"[0-9]\"))\nbfi_only %>% print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 26\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 13 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|3\"}\nbfi_dem <- bfi %>%\n  rownames_to_column(\"SID\") %>%\n  select(SID, education, gender, age)\nbfi_dem %>% print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 4\n  SID   education    gender   age\n  <chr> <chr>         <int> <int>\n1 1     <NA>              1    16\n2 2     <NA>              2    18\n3 3     <NA>              2    17\n4 4     <NA>              2    17\n5 5     <NA>              1    17\n6 6     Some College      2    21\n# ℹ 2,794 more rows\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 3. `full_join()`\n\nMost simply, we can put those back together keeping all observations.\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi_only %>%\n  full_join(bfi_dem) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(SID)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 16 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>, education <chr>, gender <int>, age <int>\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 16 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>, gender <int>, education <chr>, age <int>\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 4. `inner_join()`\n\nWe can also keep all rows present in *both* data frames\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|1-2|4-5|3\"}\nbfi_dem %>%\n  filter(row_number() %in% 1:1700) %>%\n  inner_join(\n    bfi_only %>%\n      filter(row_number() %in% 1200:2800)\n  ) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(SID)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 501 × 29\n  SID   education   gender   age    A1    A2    A3    A4    A5    C1    C2    C3\n  <chr> <chr>        <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1200  Some Colle…      2    18     1     5     6     5     5     5     6     5\n2 1201  College          2    29     1     5     6     5     5     2     1     4\n3 1202  Higher Deg…      1    46     2     5     6     5     6     6     6     6\n4 1203  Higher Deg…      1    58     5     4     4     4     5     4     4     5\n5 1204  Higher Deg…      2    38     1     4     6     6     6     4     4     5\n6 1205  Higher Deg…      2    27     2     3     1     1     1     4     2     2\n# ℹ 495 more rows\n# ℹ 17 more variables: C4 <int>, C5 <int>, E1 <int>, E2 <int>, E3 <int>,\n#   E4 <int>, E5 <int>, N1 <int>, N2 <int>, N3 <int>, N4 <int>, N5 <int>,\n#   O1 <int>, O2 <int>, O3 <int>, O4 <int>, O5 <int>\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 16 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>, gender <int>, education <chr>, age <int>\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 5. `left_join()`\n\nOr all rows present in the left (first) data frame, perhaps if it's a subset of people with complete data\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2|3\"}\nbfi_dem %>%\n  drop_na() %>%\n  left_join(bfi_only) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(SID)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,577 × 29\n  SID   education   gender   age    A1    A2    A3    A4    A5    C1    C2    C3\n  <chr> <chr>        <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 6     Some Colle…      2    21     6     6     5     6     5     6     6     6\n2 8     HS               1    19     4     3     1     5     1     3     2     4\n3 9     Below HS         1    19     4     3     6     3     3     6     6     3\n4 11    Below HS         1    21     4     4     5     6     5     4     3     5\n5 15    Below HS         1    17     4     5     2     2     1     5     5     5\n6 23    Higher Deg…      1    68     1     5     6     5     6     4     3     2\n# ℹ 2,571 more rows\n# ℹ 17 more variables: C4 <int>, C5 <int>, E1 <int>, E2 <int>, E3 <int>,\n#   E4 <int>, E5 <int>, N1 <int>, N2 <int>, N3 <int>, N4 <int>, N5 <int>,\n#   O1 <int>, O2 <int>, O3 <int>, O4 <int>, O5 <int>\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 16 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>, gender <int>, education <chr>, age <int>\n```\n:::\n:::\n\n:::\n:::\n:::\n\n## 6. `right_join()`\n\nOr all rows present in the right (second) data frame, such as I do when I join a codebook with raw data\n\n::: columns\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|3\"}\nbfi_dem %>%\n  drop_na() %>%\n  right_join(bfi_only) %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(SID)`\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID   education   gender   age    A1    A2    A3    A4    A5    C1    C2    C3\n  <chr> <chr>        <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 6     Some Colle…      2    21     6     6     5     6     5     6     6     6\n2 8     HS               1    19     4     3     1     5     1     3     2     4\n3 9     Below HS         1    19     4     3     6     3     3     6     6     3\n4 11    Below HS         1    21     4     4     5     6     5     4     3     5\n5 15    Below HS         1    17     4     5     2     2     1     5     5     5\n6 23    Higher Deg…      1    68     1     5     6     5     6     4     3     2\n# ℹ 2,794 more rows\n# ℹ 17 more variables: C4 <int>, C5 <int>, E1 <int>, E2 <int>, E3 <int>,\n#   E4 <int>, E5 <int>, N1 <int>, N2 <int>, N3 <int>, N4 <int>, N5 <int>,\n#   O1 <int>, O2 <int>, O3 <int>, O4 <int>, O5 <int>\n```\n:::\n:::\n\n:::\n:::\n\n::: column\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\nbfi %>%\n  rownames_to_column(\"SID\") %>%\n  print(n = 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,800 × 29\n  SID      A1    A2    A3    A4    A5    C1    C2    C3    C4    C5    E1    E2\n  <chr> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int> <int>\n1 1         2     4     3     4     4     2     3     3     4     4     3     3\n2 2         2     4     5     2     5     5     4     4     3     4     1     1\n3 3         5     4     5     4     4     4     5     4     2     5     2     4\n4 4         4     4     6     5     5     4     4     3     5     5     5     3\n5 5         2     3     3     4     5     4     4     5     3     2     2     2\n6 6         6     6     5     6     5     6     6     6     1     3     2     1\n# ℹ 2,794 more rows\n# ℹ 16 more variables: E3 <int>, E4 <int>, E5 <int>, N1 <int>, N2 <int>,\n#   N3 <int>, N4 <int>, N5 <int>, O1 <int>, O2 <int>, O3 <int>, O4 <int>,\n#   O5 <int>, gender <int>, education <chr>, age <int>\n```\n:::\n:::\n\n:::\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}